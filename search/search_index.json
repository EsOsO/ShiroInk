{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ShiroInk Documentation","text":"<p>Welcome to the ShiroInk documentation! ShiroInk is a powerful manga and comic book image optimization tool designed to prepare images for e-readers, tablets, and printing.</p>"},{"location":"#what-is-shiroink","title":"What is ShiroInk?","text":"<p>ShiroInk processes manga and comic book images with configurable pipelines to:</p> <ul> <li>Resize images to optimal resolutions for different devices</li> <li>Optimize image quality and file size</li> <li>Enhance contrast and sharpness</li> <li>Quantize colors for better e-reader display</li> <li>Process CBZ archives automatically</li> </ul>"},{"location":"#features","title":"Features","text":""},{"location":"#configurable-processing-pipelines","title":"\ud83c\udfa8 Configurable Processing Pipelines","text":"<p>Choose from 5 built-in presets or create your own:</p> <ul> <li>Kindle: Optimized for e-readers (default)</li> <li>Tablet: Perfect for iPad and Android tablets</li> <li>Print: High-quality for printing</li> <li>High Quality: Maximum quality preservation</li> <li>Minimal: Light processing</li> </ul>"},{"location":"#performance","title":"\ud83d\ude80 Performance","text":"<ul> <li>Multi-threaded processing</li> <li>Batch processing support</li> <li>CBZ archive support</li> <li>Dry-run mode for testing</li> </ul>"},{"location":"#flexible-configuration","title":"\ud83d\udd27 Flexible Configuration","text":"<ul> <li>Custom resolutions</li> <li>Quality levels (1-9)</li> <li>RTL (right-to-left) support for manga</li> <li>Debug mode</li> <li>Continue-on-error option</li> </ul>"},{"location":"#docker-support","title":"\ud83d\udc33 Docker Support","text":"<ul> <li>Multi-platform images (amd64, arm64)</li> <li>Pre-built containers on GitHub Container Registry</li> <li>Docker Compose configurations</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#using-docker","title":"Using Docker","text":"<pre><code>docker pull ghcr.io/esoso/shiroink:latest\n\ndocker run --rm \\\n  -v ./input:/input:ro \\\n  -v ./output:/output \\\n  ghcr.io/esoso/shiroink:latest \\\n  /input /output --pipeline kindle\n</code></pre>"},{"location":"#using-python","title":"Using Python","text":"<pre><code>pip install -r requirements.txt\npython src/main.py input/ output/ --pipeline tablet\n</code></pre>"},{"location":"#architecture-highlights","title":"Architecture Highlights","text":"<p>ShiroInk v2.0.0 features a completely redesigned architecture:</p> <ul> <li>ProcessingConfig Dataclass: Simplified configuration management</li> <li>ProgressReporter Abstraction: Testable progress tracking</li> <li>Configurable Pipelines: Strategy pattern for extensibility</li> <li>Comprehensive Error Handling: Retry logic and error tracking</li> </ul> <p>See the Architecture Overview for details.</p>"},{"location":"#cicd-devops","title":"CI/CD &amp; DevOps","text":"<p>ShiroInk includes enterprise-grade CI/CD:</p> <ul> <li>Automated testing on every PR</li> <li>Multi-platform Docker builds</li> <li>Vulnerability scanning with Trivy</li> <li>Automatic semantic versioning with Release Please</li> <li>Comprehensive test coverage</li> </ul> <p>Learn more in the CI/CD section.</p>"},{"location":"#version","title":"Version","text":"<p>Current version: 2.0.0</p> <p>See the releases page for changelog.</p>"},{"location":"#license","title":"License","text":"<p>ShiroInk is licensed under the ISC License.</p>"},{"location":"#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcd6 Read the Usage Guide</li> <li>\ud83d\udc33 Check the Docker Guide</li> <li>\ud83d\udc1b Report issues on GitHub</li> <li>\ud83d\udca1 See Contributing Guidelines</li> </ul>"},{"location":"#navigation","title":"Navigation","text":"<p>Use the navigation menu on the left to explore:</p> <ul> <li>Getting Started: Installation and usage guides</li> <li>Architecture: Deep dive into system design</li> <li>CI/CD: DevOps and automation details</li> <li>Contributing: How to contribute to ShiroInk</li> <li>API Reference: Code-level documentation</li> </ul>"},{"location":"architecture/error-handling/","title":"Error Handling System","text":""},{"location":"architecture/error-handling/#overview","title":"Overview","text":"<p>ShiroInk implements a robust error handling system that differentiates between recoverable and critical errors, provides automatic retry logic, and tracks all failures for comprehensive reporting.</p>"},{"location":"architecture/error-handling/#error-classification","title":"Error Classification","text":""},{"location":"architecture/error-handling/#warning","title":"WARNING","text":"<p>Minor issues that don't affect processing</p> <p>Examples: - File already exists - Missing metadata - Non-critical format issues</p> <p>Action: Log and continue</p>"},{"location":"architecture/error-handling/#error","title":"ERROR","text":"<p>Recoverable failures affecting individual files</p> <p>Examples: - Corrupted file - Unsupported format - Processing step failure</p> <p>Action: Log, skip file, continue processing</p>"},{"location":"architecture/error-handling/#critical","title":"CRITICAL","text":"<p>Severe errors that may compromise results</p> <p>Examples: - Directory inaccessible - Insufficient disk space - Permission denied - Batch failure threshold exceeded</p> <p>Action: Log and potentially halt batch processing</p>"},{"location":"architecture/error-handling/#exception-hierarchy","title":"Exception Hierarchy","text":"<pre><code>ShiroInkError (base)\n\u251c\u2500\u2500 ImageProcessingError\n\u251c\u2500\u2500 FileReadError\n\u251c\u2500\u2500 FileWriteError\n\u251c\u2500\u2500 CBZExtractionError\n\u251c\u2500\u2500 CBZCreationError\n\u2514\u2500\u2500 RetryableError\n</code></pre>"},{"location":"architecture/error-handling/#error-tracking","title":"Error Tracking","text":"<p>The <code>ErrorTracker</code> class centralizes error collection and statistics:</p>"},{"location":"architecture/error-handling/#key-features","title":"Key Features","text":"<ul> <li>Tracks all errors with full context</li> <li>Categorizes by severity level</li> <li>Provides aggregated statistics</li> <li>Generates summary reports</li> </ul>"},{"location":"architecture/error-handling/#usage","title":"Usage","text":"<pre><code>from error_handler import ErrorTracker, ErrorSeverity\n\ntracker = ErrorTracker()\n\n# Record an error\ntracker.add_error(\n    error=ImageProcessingError(\"Failed to process\"),\n    path=Path(\"image.jpg\"),\n    severity=ErrorSeverity.ERROR,\n    step=\"contrast\"\n)\n\n# Get statistics\nsummary = tracker.get_summary()\n# {\n#   'total_errors': 1,\n#   'warnings': 0,\n#   'errors': 1,\n#   'critical': 0,\n#   'files_with_errors': 1,\n#   'errors_by_step': {'contrast': 1}\n# }\n</code></pre>"},{"location":"architecture/error-handling/#retry-logic","title":"Retry Logic","text":"<p>Automatic retry with exponential backoff for transient failures:</p> <pre><code>@retry_on_error(max_retries=3, delay=1.0, backoff=2.0)\ndef process_file(path: Path) -&gt; None:\n    # Processing logic\n    pass\n</code></pre> <p>Strategy: - Initial delay: 1 second - Backoff multiplier: 2x - Total attempts: 4 (initial + 3 retries) - Timeline: 0s, 1s, 3s, 7s</p>"},{"location":"architecture/error-handling/#configuration","title":"Configuration","text":""},{"location":"architecture/error-handling/#processingconfig","title":"ProcessingConfig","text":"<pre><code>@dataclass\nclass ProcessingConfig:\n    continue_on_error: bool = True  # Continue despite errors\n    max_retries: int = 3            # Retry attempts for I/O\n    debug: bool = False             # Verbose error details\n</code></pre>"},{"location":"architecture/error-handling/#behavior","title":"Behavior","text":"<p>continue_on_error = True (Default) - Process all files despite errors - Track and report failures - Exit code: 0 (success), 1 (errors), 2 (critical)</p> <p>continue_on_error = False - Stop on first error - Useful for strict validation - Exit code: 0 (success), 1+ (failure)</p>"},{"location":"architecture/error-handling/#exit-codes","title":"Exit Codes","text":"<ul> <li><code>0</code>: Success - no errors</li> <li><code>1</code>: Processing completed with non-critical errors</li> <li><code>2</code>: Critical errors occurred</li> </ul>"},{"location":"architecture/error-handling/#error-summary-report","title":"Error Summary Report","text":"<pre><code>ERROR SUMMARY\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nTotal errors: 5\n  Warnings: 1\n  Errors: 3\n  Critical: 1\n\nFiles affected: 4\nMost problematic: /path/to/file.jpg (2 errors)\n\nErrors by step:\n  image_processing: 3\n  cbz_creation: 1\n  cbz_extraction: 1\n\nFirst 5 errors:\n  [ERROR] ImageProcessingError: Failed at step contrast\n  [ERROR] FileReadError: Permission denied\n  [CRITICAL] CBZCreationError: Invalid archive\n  ...\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n</code></pre>"},{"location":"architecture/error-handling/#usage-examples","title":"Usage Examples","text":""},{"location":"architecture/error-handling/#standard-processing","title":"Standard Processing","text":"<pre><code># Continue despite errors (default)\npython src/main.py input/ output/ --pipeline kindle\n</code></pre> <p>Output shows total errors and summary.</p>"},{"location":"architecture/error-handling/#strict-mode","title":"Strict Mode","text":"<pre><code>config = ProcessingConfig(\n    src_dir=Path(\"input\"),\n    dest_dir=Path(\"output\"),\n    continue_on_error=False  # Stop on first error\n)\n</code></pre>"},{"location":"architecture/error-handling/#custom-retry-configuration","title":"Custom Retry Configuration","text":"<pre><code>config = ProcessingConfig(\n    src_dir=Path(\"input\"),\n    dest_dir=Path(\"output\"),\n    max_retries=5  # More aggressive retry\n)\n</code></pre>"},{"location":"architecture/error-handling/#debug-mode","title":"Debug Mode","text":"<pre><code>python src/main.py input/ output/ --debug\n</code></pre> <p>Shows: - All retry attempts - Detailed error messages - Processing statistics</p>"},{"location":"architecture/error-handling/#integration-with-pipeline","title":"Integration with Pipeline","text":"<p>Errors during pipeline execution are caught and tracked:</p> <pre><code>def process(image_path: Path, output_path: Path) -&gt; None:\n    try:\n        pipeline = config.get_pipeline()\n        image = Image.open(image_path)\n        processed = pipeline.process(image)\n        processed.save(output_path)\n    except Exception as e:\n        error_tracker.add_error(\n            error=e,\n            path=image_path,\n            severity=ErrorSeverity.ERROR,\n            step=\"pipeline\"\n        )\n\n        if not config.continue_on_error:\n            raise\n</code></pre>"},{"location":"architecture/error-handling/#testing","title":"Testing","text":""},{"location":"architecture/error-handling/#unit-tests","title":"Unit Tests","text":"<pre><code># Test error tracking\npython -m pytest tests/unit/test_error_handler.py -v\n\n# Test retry logic\npython -m pytest tests/unit/test_retry.py -v\n</code></pre>"},{"location":"architecture/error-handling/#error-simulation","title":"Error Simulation","text":"<pre><code># Test error tracking\ntracker = ErrorTracker()\ntracker.add_error(\n    error=Exception(\"Test error\"),\n    path=Path(\"test.jpg\"),\n    severity=ErrorSeverity.ERROR\n)\n\nassert tracker.has_errors()\nassert tracker.get_summary()[\"total_errors\"] == 1\n</code></pre>"},{"location":"architecture/error-handling/#best-practices","title":"Best Practices","text":""},{"location":"architecture/error-handling/#development-mode","title":"Development Mode","text":"<pre><code>ProcessingConfig(\n    continue_on_error=False,  # Fail fast\n    max_retries=1,            # Quick feedback\n    debug=True                # Full logging\n)\n</code></pre>"},{"location":"architecture/error-handling/#production-mode","title":"Production Mode","text":"<pre><code>ProcessingConfig(\n    continue_on_error=True,   # Process everything\n    max_retries=3,            # Reasonable retry\n    debug=False               # Summary only\n)\n</code></pre>"},{"location":"architecture/error-handling/#batch-processing","title":"Batch Processing","text":"<pre><code>ProcessingConfig(\n    continue_on_error=True,   # Never stop\n    max_retries=5,            # Aggressive retry\n    debug=True                # Full analysis log\n)\n</code></pre>"},{"location":"architecture/error-handling/#error-prevention","title":"Error Prevention","text":""},{"location":"architecture/error-handling/#before-processing","title":"Before Processing","text":"<ol> <li>Validate directory access</li> <li>Check disk space</li> <li>Verify file permissions</li> <li>Validate file formats</li> </ol>"},{"location":"architecture/error-handling/#during-processing","title":"During Processing","text":"<ol> <li>Use try-catch blocks</li> <li>Implement retry logic</li> <li>Track all failures</li> <li>Log contextual information</li> </ol>"},{"location":"architecture/error-handling/#after-processing","title":"After Processing","text":"<ol> <li>Generate summary report</li> <li>Identify patterns</li> <li>Suggest corrective actions</li> <li>Archive logs for analysis</li> </ol>"},{"location":"architecture/error-handling/#monitoring-and-logging","title":"Monitoring and Logging","text":"<p>Error tracking data can be used for:</p> <ul> <li>Monitoring: Alert on critical errors</li> <li>Analytics: Identify problematic files or steps</li> <li>Improvement: Fix recurring issues</li> <li>Audit: Track all processing failures</li> </ul>"},{"location":"architecture/error-handling/#related-documentation","title":"Related Documentation","text":"<ul> <li>Pipeline System - Processing steps</li> <li>Progress Reporting - User feedback</li> <li>Configuration - Setup instructions</li> </ul>"},{"location":"architecture/overview/","title":"ShiroInk Architecture Overview","text":"<p>ShiroInk is a modular image processing system designed for e-book and manga optimization. This document outlines the core architectural components.</p>"},{"location":"architecture/overview/#core-components","title":"Core Components","text":""},{"location":"architecture/overview/#1-image-pipeline-system","title":"1. Image Pipeline System","text":"<p>The pipeline is a configurable, modular processing system that transforms images through a series of steps:</p> <ul> <li>ResizeStep: Resizes images to exact device dimensions</li> <li>ContrastStep: Adjusts image contrast for e-ink displays</li> <li>SharpenStep: Enhances image sharpness</li> <li>QuantizeStep: Reduces color palette for file size optimization</li> </ul> <p>Each step implements the <code>ProcessingStep</code> interface, allowing easy composition and customization.</p> <p>Available presets: - <code>kindle</code>: Optimized for e-ink displays (default) - <code>tablet</code>: Preserves colors for LCD/tablet devices - <code>high_quality</code>: Enhanced processing for archive storage - <code>minimal</code>: No processing (pass-through)</p>"},{"location":"architecture/overview/#2-configuration-system","title":"2. Configuration System","text":"<p>The <code>ProcessingConfig</code> dataclass centralizes all configuration parameters:</p> <pre><code>@dataclass\nclass ProcessingConfig:\n    src_dir: Path\n    dest_dir: Path\n    resolution: tuple[int, int]\n    pipeline_preset: str = \"kindle\"\n    continue_on_error: bool = True\n    max_retries: int = 3\n    # ... other options\n</code></pre> <p>This eliminates scattered function parameters and provides validated, type-safe configuration.</p>"},{"location":"architecture/overview/#3-progress-reporting","title":"3. Progress Reporting","text":"<p>An abstract <code>ProgressReporter</code> interface decouples progress tracking from the UI framework:</p> <ul> <li>ConsoleProgressReporter: Rich-formatted console output</li> <li>SilentProgressReporter: No output (testing)</li> <li>FileProgressReporter: File-based logging</li> </ul> <p>This allows flexible reporting without coupling business logic to UI frameworks.</p>"},{"location":"architecture/overview/#4-error-handling","title":"4. Error Handling","text":"<p>A robust error handling system with:</p> <ul> <li>Exception hierarchy: Custom exceptions for different error types</li> <li>Error tracking: Centralized error collection and statistics</li> <li>Retry logic: Automatic retries with exponential backoff</li> <li>Configurable behavior: Continue-on-error or fail-fast modes</li> </ul> <p>Exit codes indicate result status: - <code>0</code>: Success - <code>1</code>: Errors occurred - <code>2</code>: Critical errors occurred</p>"},{"location":"architecture/overview/#design-patterns","title":"Design Patterns","text":"<ul> <li>Strategy Pattern: Pluggable processing steps and reporters</li> <li>Factory Pattern: Pipeline preset creation</li> <li>Dependency Injection: Configuration and reporter injection</li> <li>Chain of Responsibility: Sequential pipeline execution</li> </ul>"},{"location":"architecture/overview/#code-organization","title":"Code Organization","text":"<pre><code>src/\n\u251c\u2500\u2500 image_pipeline/        # Image processing modules\n\u2502   \u251c\u2500\u2500 pipeline.py        # Pipeline abstraction\n\u2502   \u251c\u2500\u2500 presets.py         # Pipeline presets\n\u2502   \u251c\u2500\u2500 resize_step.py     # Exact dimension resizing\n\u2502   \u251c\u2500\u2500 contrast.py        # Contrast adjustment\n\u2502   \u251c\u2500\u2500 sharpen.py         # Sharpening\n\u2502   \u2514\u2500\u2500 ...                # Other processing steps\n\u251c\u2500\u2500 config.py              # Configuration management\n\u251c\u2500\u2500 progress_reporter.py   # Progress abstraction\n\u251c\u2500\u2500 error_handler.py       # Error tracking\n\u2514\u2500\u2500 main.py                # Entry point\n</code></pre>"},{"location":"architecture/overview/#key-design-principles","title":"Key Design Principles","text":"<ol> <li>Single Responsibility: Each component has one clear purpose</li> <li>Open/Closed: Easy to extend (new steps/reporters) without modification</li> <li>Dependency Inversion: Components depend on abstractions, not implementations</li> <li>Backward Compatibility: Default behavior unchanged; new features are opt-in</li> </ol>"},{"location":"architecture/overview/#extension-points","title":"Extension Points","text":"<p>To add a new processing step:</p> <pre><code>from image_pipeline.pipeline import ProcessingStep\n\nclass CustomStep(ProcessingStep):\n    def process(self, image: Image.Image) -&gt; Image.Image:\n        # Your processing logic\n        return image\n\n    def get_name(self) -&gt; str:\n        return \"CustomStep\"\n</code></pre> <p>To add a new reporter:</p> <pre><code>from progress_reporter import ProgressReporter\n\nclass CustomReporter(ProgressReporter):\n    def log(self, message: str, level: str = \"info\") -&gt; None:\n        # Your logging logic\n        pass\n</code></pre>"},{"location":"architecture/pipeline-system/","title":"Image Processing Pipeline System","text":""},{"location":"architecture/pipeline-system/#overview","title":"Overview","text":"<p>The image processing pipeline is a modular, configurable system for transforming images through a sequence of processing steps. Each step implements the <code>ProcessingStep</code> interface, allowing flexible composition and customization.</p>"},{"location":"architecture/pipeline-system/#architecture","title":"Architecture","text":""},{"location":"architecture/pipeline-system/#core-concepts","title":"Core Concepts","text":"<p>ProcessingStep (Interface) - Abstract base class for all processing operations - Must implement <code>process()</code> and <code>get_name()</code> methods - Encapsulates both configuration and execution</p> <p>ImagePipeline (Container) - Manages a sequence of ProcessingStep instances - Executes steps in order (Chain of Responsibility pattern) - Supports dynamic add/remove operations - Provides fluent interface for construction</p> <p>Pipeline Presets (Factory) - Pre-configured pipelines for common use cases - Optimized for specific device types and quality requirements - Easy to extend or customize</p>"},{"location":"architecture/pipeline-system/#available-steps","title":"Available Steps","text":""},{"location":"architecture/pipeline-system/#resizestep","title":"ResizeStep","text":"<p>Resizes images to exact device screen dimensions.</p> <p>Configuration: <pre><code>ResizeStep(width: int, height: int, fit_mode: str = \"contain\")\n</code></pre></p> <p>Use case: Ensure output matches exact device resolution</p>"},{"location":"architecture/pipeline-system/#contraststep","title":"ContrastStep","text":"<p>Adjusts image contrast for better readability on e-ink displays.</p> <p>Configuration: <pre><code>ContrastStep(factor: float = 1.5)\n</code></pre></p> <p>Use case: Enhance visibility on low-contrast displays</p>"},{"location":"architecture/pipeline-system/#sharpenstep","title":"SharpenStep","text":"<p>Enhances edge sharpness and detail clarity.</p> <p>Configuration: <pre><code>SharpenStep(factor: float = 1.2)\n</code></pre></p> <p>Use case: Improve text and line clarity</p>"},{"location":"architecture/pipeline-system/#quantizestep","title":"QuantizeStep","text":"<p>Reduces color palette to decrease file size.</p> <p>Configuration: <pre><code>QuantizeStep(palette: bytes = Palette16)\n</code></pre></p> <p>Use case: Optimize for e-ink displays or reduce file size</p>"},{"location":"architecture/pipeline-system/#preset-pipelines","title":"Preset Pipelines","text":""},{"location":"architecture/pipeline-system/#kindle-default","title":"kindle (Default)","text":"<p>Optimized for Amazon Kindle e-ink readers.</p> <p>Steps: - ResizeStep (to device resolution) - ContrastStep (factor: 1.5) - SharpenStep (factor: 1.2) - QuantizeStep (16 colors)</p> <p>Best for: E-ink readers, file size optimization</p>"},{"location":"architecture/pipeline-system/#tablet","title":"tablet","text":"<p>Optimized for LCD/tablet displays.</p> <p>Steps: - ResizeStep (to device resolution) - ContrastStep (factor: 1.3) - SharpenStep (factor: 1.1)</p> <p>Best for: Color LCD devices, web viewing</p>"},{"location":"architecture/pipeline-system/#high_quality","title":"high_quality","text":"<p>Maximum quality for archival storage.</p> <p>Steps: - ResizeStep (to device resolution) - ContrastStep (factor: 1.2) - SharpenStep (factor: 1.4)</p> <p>Best for: Archive storage, future-proofing</p>"},{"location":"architecture/pipeline-system/#minimal","title":"minimal","text":"<p>No processing (pass-through).</p> <p>Steps: None</p> <p>Best for: Quick conversions, preserving original quality</p>"},{"location":"architecture/pipeline-system/#custom","title":"custom","text":"<p>Build a custom pipeline programmatically.</p> <pre><code>pipeline = ImagePipeline()\npipeline.add_step(ContrastStep(factor=1.8))\npipeline.add_step(SharpenStep(factor=1.5))\n</code></pre>"},{"location":"architecture/pipeline-system/#usage-examples","title":"Usage Examples","text":""},{"location":"architecture/pipeline-system/#using-presets-via-cli","title":"Using Presets via CLI","text":"<pre><code># Default (kindle preset)\npython src/main.py input/ output/\n\n# Tablet optimization\npython src/main.py input/ output/ --pipeline tablet\n\n# High quality archive\npython src/main.py input/ output/ --pipeline high_quality\n\n# No processing\npython src/main.py input/ output/ --pipeline minimal\n</code></pre>"},{"location":"architecture/pipeline-system/#programmatic-usage","title":"Programmatic Usage","text":"<pre><code>from image_pipeline.presets import PipelinePresets\nfrom image_pipeline import process\n\n# Using a preset\npipeline = PipelinePresets.kindle()\nprocess(input_path, output_path, resolution=(1072, 1448), pipeline=pipeline)\n\n# Using custom pipeline\npipeline = ImagePipeline()\npipeline.add_step(ContrastStep(factor=1.8))\npipeline.add_step(SharpenStep(factor=1.5))\n\nprocess(input_path, output_path, resolution=(1072, 1448), pipeline=pipeline)\n\n# Method chaining\npipeline = (ImagePipeline()\n    .add_step(ContrastStep(1.5))\n    .add_step(SharpenStep(1.2)))\n</code></pre>"},{"location":"architecture/pipeline-system/#dynamic-modification","title":"Dynamic Modification","text":"<pre><code># Start with preset\npipeline = PipelinePresets.kindle()\n\n# Modify it\npipeline.remove_step(\"Quantize\")  # Preserve colors\npipeline.add_step(CustomStep())   # Add custom processing\n\nprocess(input_path, output_path, resolution=res, pipeline=pipeline)\n</code></pre>"},{"location":"architecture/pipeline-system/#creating-custom-steps","title":"Creating Custom Steps","text":"<p>To add a new processing step:</p> <pre><code>from image_pipeline.pipeline import ProcessingStep\nfrom PIL import Image, ImageFilter\n\nclass BlurStep(ProcessingStep):\n    \"\"\"Apply Gaussian blur to image.\"\"\"\n\n    def __init__(self, radius: float = 2.0):\n        super().__init__(radius=radius)\n        self.radius = radius\n\n    def process(self, image: Image.Image) -&gt; Image.Image:\n        return image.filter(ImageFilter.GaussianBlur(self.radius))\n\n    def get_name(self) -&gt; str:\n        return \"Blur\"\n\n# Use it\npipeline = ImagePipeline()\npipeline.add_step(BlurStep(radius=3.0))\n</code></pre>"},{"location":"architecture/pipeline-system/#creating-custom-presets","title":"Creating Custom Presets","text":"<pre><code>from image_pipeline.presets import PipelinePresets\nfrom image_pipeline.pipeline import ImagePipeline\n\n# Add to PipelinePresets class\n@staticmethod\ndef manga_optimized() -&gt; ImagePipeline:\n    \"\"\"Pipeline optimized for manga.\"\"\"\n    pipeline = ImagePipeline()\n    pipeline.add_step(ContrastStep(factor=1.8))\n    pipeline.add_step(SharpenStep(factor=1.5))\n    pipeline.add_step(QuantizeStep())\n    return pipeline\n\n# Use it\npipeline = PipelinePresets.manga_optimized()\n</code></pre>"},{"location":"architecture/pipeline-system/#design-patterns","title":"Design Patterns","text":""},{"location":"architecture/pipeline-system/#strategy-pattern","title":"Strategy Pattern","text":"<p>Each ProcessingStep is a strategy that can be swapped or replaced.</p>"},{"location":"architecture/pipeline-system/#chain-of-responsibility","title":"Chain of Responsibility","text":"<p>Pipeline executes steps sequentially, each transforming the image for the next.</p>"},{"location":"architecture/pipeline-system/#factory-pattern","title":"Factory Pattern","text":"<p>PipelinePresets creates pre-configured pipelines.</p>"},{"location":"architecture/pipeline-system/#builder-pattern","title":"Builder Pattern","text":"<p>Fluent interface (<code>add_step()</code>, <code>remove_step()</code>) for constructing pipelines.</p>"},{"location":"architecture/pipeline-system/#testing","title":"Testing","text":""},{"location":"architecture/pipeline-system/#unit-tests","title":"Unit Tests","text":"<pre><code># Run pipeline tests\npython -m pytest tests/unit/test_pipeline.py -v\n\n# Run device preset tests\npython -m pytest tests/unit/test_devices.py -v\n</code></pre>"},{"location":"architecture/pipeline-system/#functional-tests","title":"Functional Tests","text":"<pre><code># Test different presets\npython src/main.py test_images/ output/ --pipeline kindle\npython src/main.py test_images/ output/ --pipeline tablet\npython src/main.py test_images/ output/ --pipeline high_quality\n</code></pre>"},{"location":"architecture/pipeline-system/#configuration","title":"Configuration","text":"<p>Pipeline preset can be specified via CLI or configuration:</p> <pre><code>from config import ProcessingConfig\n\nconfig = ProcessingConfig(\n    src_dir=Path(\"input\"),\n    dest_dir=Path(\"output\"),\n    pipeline_preset=\"tablet\"  # or custom instance\n)\n</code></pre>"},{"location":"architecture/pipeline-system/#benefits","title":"Benefits","text":"<ol> <li>Modularity: Each step is independent and testable</li> <li>Flexibility: Easy to add, remove, or reorder steps</li> <li>Extensibility: Create custom steps without modifying core code</li> <li>Performance: Disable expensive steps when not needed</li> <li>Reusability: Share pipelines across projects</li> </ol>"},{"location":"architecture/pipeline-system/#migration-guide","title":"Migration Guide","text":""},{"location":"architecture/pipeline-system/#before-hardcoded-pipeline","title":"Before (Hardcoded Pipeline)","text":"<pre><code>img = contrast(img)\nimg = sharpen(img)\nimg = quantize(img)\n</code></pre>"},{"location":"architecture/pipeline-system/#after-flexible-pipeline","title":"After (Flexible Pipeline)","text":"<pre><code>pipeline = PipelinePresets.kindle()\nimg = pipeline.process(img)\n</code></pre>"},{"location":"architecture/progress-reporter/","title":"Progress Reporting Architecture","text":""},{"location":"architecture/progress-reporter/#overview","title":"Overview","text":"<p>ShiroInk uses an abstract <code>ProgressReporter</code> interface to decouple progress tracking from specific UI frameworks. This enables flexible reporting without coupling business logic to console output or other UI dependencies.</p>"},{"location":"architecture/progress-reporter/#architecture","title":"Architecture","text":""},{"location":"architecture/progress-reporter/#the-problem","title":"The Problem","text":"<p>Without abstraction: - Business logic tightly coupled to Rich library - Testing requires complex UI mocking - Difficult to add new reporting methods - UI concerns mixed with processing logic</p>"},{"location":"architecture/progress-reporter/#the-solution","title":"The Solution","text":"<p>Abstract <code>ProgressReporter</code> interface enables: - Multiple reporting implementations - Easy testing without UI - Flexible output channels - Clear separation of concerns</p>"},{"location":"architecture/progress-reporter/#progressreporter-interface","title":"ProgressReporter Interface","text":"<pre><code>class ProgressReporter(ABC):\n    \"\"\"Abstract interface for progress reporting.\"\"\"\n\n    @abstractmethod\n    def log(self, message: str, level: str = \"info\") -&gt; None:\n        \"\"\"Log a message.\"\"\"\n        pass\n\n    @abstractmethod\n    def add_task(self, description: str, total: int) -&gt; Any:\n        \"\"\"Create a progress task.\"\"\"\n        pass\n\n    @abstractmethod\n    def advance_task(self, task_id: Any, advance: int = 1) -&gt; None:\n        \"\"\"Update task progress.\"\"\"\n        pass\n</code></pre>"},{"location":"architecture/progress-reporter/#implementations","title":"Implementations","text":""},{"location":"architecture/progress-reporter/#consoleprogressreporter","title":"ConsoleProgressReporter","text":"<p>Rich-formatted console output with colors and progress bars.</p> <p>Features: - Colored output by log level - Progress bars for file processing - Real-time status updates - Professional formatting</p> <p>Use case: Interactive command-line use</p> <pre><code>from progress_reporter import ConsoleProgressReporter\n\nreporter = ConsoleProgressReporter()\nreporter.log(\"Processing started\", level=\"info\")\ntask_id = reporter.add_task(\"Processing files\", total=100)\nreporter.advance_task(task_id, 10)\n</code></pre>"},{"location":"architecture/progress-reporter/#silentprogressreporter","title":"SilentProgressReporter","text":"<p>No output at all.</p> <p>Features: - Zero I/O overhead - No console pollution - Completely silent</p> <p>Use cases: - Unit testing - CI/CD pipelines - Headless environments - Background processing</p> <pre><code>from progress_reporter import SilentProgressReporter\n\nreporter = SilentProgressReporter()\nmain(config, reporter)  # Runs silently\n</code></pre>"},{"location":"architecture/progress-reporter/#fileprogressreporter","title":"FileProgressReporter","text":"<p>Logs to a file instead of console.</p> <p>Features: - Persistent log file - Time-stamped entries - Structured logging - No console output</p> <p>Use cases: - Batch processing - Server environments - Audit trails - Debugging complex issues</p> <pre><code>from progress_reporter import FileProgressReporter\nfrom pathlib import Path\n\nreporter = FileProgressReporter(Path(\"processing.log\"))\nmain(config, reporter)\n# Creates: processing.log with all messages\n</code></pre>"},{"location":"architecture/progress-reporter/#dependency-injection","title":"Dependency Injection","text":""},{"location":"architecture/progress-reporter/#pattern","title":"Pattern","text":"<pre><code>def main(config: ProcessingConfig, reporter: ProgressReporter):\n    \"\"\"Main processing function with injected reporter.\"\"\"\n    reporter.log(\"Starting processing\", level=\"info\")\n\n    # Business logic doesn't know or care about reporter type\n    pipeline = config.get_pipeline()\n    process_files(config, pipeline, reporter)\n\n    reporter.log(\"Completed\", level=\"info\")\n</code></pre>"},{"location":"architecture/progress-reporter/#benefits","title":"Benefits","text":"<ol> <li>Testability: Use SilentProgressReporter in tests</li> <li>Flexibility: Swap implementations without changing code</li> <li>Separation: Business logic independent of UI</li> <li>Extensibility: Easy to add new reporter types</li> </ol>"},{"location":"architecture/progress-reporter/#creating-custom-reporters","title":"Creating Custom Reporters","text":"<pre><code>from progress_reporter import ProgressReporter\nfrom pathlib import Path\n\nclass CustomReporter(ProgressReporter):\n    \"\"\"Custom reporter implementation.\"\"\"\n\n    def __init__(self, config: dict):\n        self.config = config\n\n    def log(self, message: str, level: str = \"info\") -&gt; None:\n        # Your logging logic\n        print(f\"[{level.upper()}] {message}\")\n\n    def add_task(self, description: str, total: int) -&gt; str:\n        task_id = str(uuid.uuid4())\n        print(f\"Task: {description}\")\n        return task_id\n\n    def advance_task(self, task_id: str, advance: int = 1) -&gt; None:\n        # Update progress tracking\n        pass\n\n# Use it\nreporter = CustomReporter({})\nmain(config, reporter)\n</code></pre>"},{"location":"architecture/progress-reporter/#usage-examples","title":"Usage Examples","text":""},{"location":"architecture/progress-reporter/#standard-processing-console","title":"Standard Processing (Console)","text":"<pre><code>python src/main.py input/ output/ --pipeline kindle\n</code></pre> <p>Output: <pre><code>Processing images... \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 50%\nProcessing: image1.jpg... \u2713\nProcessing: image2.jpg... \u2713\n</code></pre></p>"},{"location":"architecture/progress-reporter/#silent-processing-testing","title":"Silent Processing (Testing)","text":"<pre><code>from progress_reporter import SilentProgressReporter\n\ndef test_processing():\n    config = ProcessingConfig(\n        src_dir=Path(\"test_input\"),\n        dest_dir=Path(\"test_output\")\n    )\n    reporter = SilentProgressReporter()\n\n    # No console output during test\n    main(config, reporter)\n\n    # Verify results\n    assert Path(\"test_output/image.jpg\").exists()\n</code></pre>"},{"location":"architecture/progress-reporter/#file-logging","title":"File Logging","text":"<pre><code>from progress_reporter import FileProgressReporter\n\nconfig = ProcessingConfig(\n    src_dir=Path(\"input\"),\n    dest_dir=Path(\"output\")\n)\nreporter = FileProgressReporter(Path(\"processing.log\"))\n\nmain(config, reporter)\n\n# Review log\nwith open(\"processing.log\") as f:\n    print(f.read())\n</code></pre>"},{"location":"architecture/progress-reporter/#batch-processing","title":"Batch Processing","text":"<pre><code># Run silently with file logging\npython src/main.py input/ output/ &gt; batch.log 2&gt;&amp;1\n\n# Check results\ntail batch.log\n</code></pre>"},{"location":"architecture/progress-reporter/#integration-with-error-handling","title":"Integration with Error Handling","text":"<p>The reporter is used throughout error handling:</p> <pre><code>def main(config: ProcessingConfig, reporter: ProgressReporter) -&gt; int:\n    error_tracker = ErrorTracker()\n\n    try:\n        process_files(config, reporter, error_tracker)\n    except Exception as e:\n        reporter.log(f\"Error: {e}\", level=\"error\")\n        error_tracker.add_error(e, None, ErrorSeverity.CRITICAL)\n\n    # Report summary\n    if error_tracker.has_errors():\n        summary = error_tracker.get_summary()\n        reporter.log(\n            f\"Completed with {summary['total_errors']} errors\",\n            level=\"error\"\n        )\n        return 1\n\n    reporter.log(\"Completed successfully\", level=\"info\")\n    return 0\n</code></pre>"},{"location":"architecture/progress-reporter/#log-levels","title":"Log Levels","text":""},{"location":"architecture/progress-reporter/#info","title":"INFO","text":"<p>General informational messages.</p> <pre><code>reporter.log(\"Starting processing\", level=\"info\")\n</code></pre>"},{"location":"architecture/progress-reporter/#warning","title":"WARNING","text":"<p>Issues that don't stop processing.</p> <pre><code>reporter.log(\"File already exists, skipping\", level=\"warning\")\n</code></pre>"},{"location":"architecture/progress-reporter/#error","title":"ERROR","text":"<p>Recoverable errors.</p> <pre><code>reporter.log(\"Failed to process file, skipping\", level=\"error\")\n</code></pre>"},{"location":"architecture/progress-reporter/#debug","title":"DEBUG","text":"<p>Detailed technical information (if debug mode enabled).</p> <pre><code>if config.debug:\n    reporter.log(\"Opening image pipeline\", level=\"debug\")\n</code></pre>"},{"location":"architecture/progress-reporter/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>ConsoleProgressReporter: Slight I/O overhead for formatting</li> <li>SilentProgressReporter: Zero overhead (ideal for testing)</li> <li>FileProgressReporter: Disk I/O but buffered for efficiency</li> </ul>"},{"location":"architecture/progress-reporter/#testing-strategy","title":"Testing Strategy","text":""},{"location":"architecture/progress-reporter/#unit-tests-with-silentreporter","title":"Unit Tests with SilentReporter","text":"<pre><code>def test_file_processing():\n    config = ProcessingConfig(...)\n    reporter = SilentProgressReporter()\n\n    # No output, fast execution\n    result = process_files(config, reporter)\n\n    assert result is True\n</code></pre>"},{"location":"architecture/progress-reporter/#integration-tests-with-filereporter","title":"Integration Tests with FileReporter","text":"<pre><code>def test_batch_processing():\n    log_file = Path(\"test.log\")\n    reporter = FileProgressReporter(log_file)\n\n    main(config, reporter)\n\n    # Verify log contents\n    log_contents = log_file.read_text()\n    assert \"completed\" in log_contents.lower()\n</code></pre>"},{"location":"architecture/progress-reporter/#extension-points","title":"Extension Points","text":""},{"location":"architecture/progress-reporter/#adding-a-new-reporter-type","title":"Adding a New Reporter Type","text":"<ol> <li>Inherit from <code>ProgressReporter</code></li> <li>Implement required methods</li> <li>Use like any other reporter</li> </ol> <pre><code>class MetricsReporter(ProgressReporter):\n    def __init__(self, metrics_endpoint: str):\n        self.endpoint = metrics_endpoint\n\n    def log(self, message: str, level: str = \"info\") -&gt; None:\n        # Send to metrics service\n        requests.post(self.endpoint, json={\"message\": message, \"level\": level})\n</code></pre>"},{"location":"architecture/progress-reporter/#adding-a-new-log-level","title":"Adding a New Log Level","text":"<p>Extend log levels by modifying reporter implementations:</p> <pre><code>def log(self, message: str, level: str = \"info\") -&gt; None:\n    if level == \"trace\":\n        # Ultra-detailed logging\n        self._trace(message)\n    elif level == \"debug\":\n        # Debug information\n        self._debug(message)\n</code></pre>"},{"location":"architecture/progress-reporter/#related-documentation","title":"Related Documentation","text":"<ul> <li>Pipeline System - Processing pipeline</li> <li>Error Handling - Error tracking</li> <li>Configuration - Setup instructions</li> </ul>"},{"location":"cicd/analysis-archived-2025-12-31/","title":"CI/CD and Docker Container Analysis - ShiroInk","text":""},{"location":"cicd/analysis-archived-2025-12-31/#executive-summary","title":"Executive Summary","text":"<p>This document provides a comprehensive analysis of ShiroInk's CI/CD pipeline and Docker containerization strategy, including identified issues, recommendations, and compatibility verification with the new architectural improvements.</p> <p>Status: \u2705 Docker build successful with new features (tested locally) Image Size: 245MB Python Version: 3.13.7-slim CI/CD Platform: GitHub Actions Container Registry: GitHub Container Registry (ghcr.io)</p>"},{"location":"cicd/analysis-archived-2025-12-31/#1-cicd-pipeline-analysis","title":"1. CI/CD Pipeline Analysis","text":""},{"location":"cicd/analysis-archived-2025-12-31/#11-workflow-configuration","title":"1.1 Workflow Configuration","text":"<p>File: <code>.github/workflows/build-and-push-image.yml</code></p>"},{"location":"cicd/analysis-archived-2025-12-31/#trigger-configuration","title":"Trigger Configuration","text":"<pre><code>on:\n  push:\n    tags: ['v*.*.*']\n</code></pre> <p>Analysis: - \u2705 Good: Only triggers on semantic version tags (v1.0.0, v2.1.3, etc.) - \u2705 Good: Prevents unnecessary builds on every commit - \u26a0\ufe0f Issue: No CI validation on pull requests or feature branches - \u26a0\ufe0f Issue: No automated testing before building the container</p> <p>Recommendation: Add pre-build validation workflow for PRs</p>"},{"location":"cicd/analysis-archived-2025-12-31/#environment-variables","title":"Environment Variables","text":"<pre><code>env:\n  REGISTRY: ghcr.io\n  IMAGE_NAME: ${{ github.repository }}\n</code></pre> <p>Analysis: - \u2705 Good: Uses GitHub Container Registry (free for public repos) - \u2705 Good: Image name automatically matches repository name - \u2705 Good: Centralized configuration</p>"},{"location":"cicd/analysis-archived-2025-12-31/#12-pipeline-jobs","title":"1.2 Pipeline Jobs","text":""},{"location":"cicd/analysis-archived-2025-12-31/#job-build-and-push-image","title":"Job: build-and-push-image","text":"<p>Runner: <code>ubuntu-latest</code> Permissions: - <code>contents: read</code> - Read repository code - <code>packages: write</code> - Push to ghcr.io - <code>attestations: write</code> - Generate attestations - <code>id-token: write</code> - OIDC token for attestations</p> <p>Analysis: - \u2705 Good: Minimal required permissions (security best practice) - \u2705 Good: Includes artifact attestation (supply chain security) - \u2705 Good: Uses latest Ubuntu runner</p>"},{"location":"cicd/analysis-archived-2025-12-31/#pipeline-steps-analysis","title":"Pipeline Steps Analysis","text":"Step Action Version Status Notes 1. Checkout <code>actions/checkout@v4</code> v4 \u2705 Good Latest version 2. Login <code>docker/login-action</code> SHA-pinned \u2705 Good SHA: 65b78e6 3. Metadata <code>docker/metadata-action</code> SHA-pinned \u2705 Good SHA: 9ec57ed 4. Build/Push <code>docker/build-push-action</code> SHA-pinned \u2705 Good SHA: f2a1d5e 5. Attestation <code>actions/attest-build-provenance</code> v2 \u2705 Good Latest version <p>Security Analysis: - \u2705 Excellent: Actions are SHA-pinned (prevents supply chain attacks) - \u2705 Excellent: Artifact attestation enabled (SLSA provenance) - \u2705 Good: Uses GITHUB_TOKEN (no hardcoded credentials)</p>"},{"location":"cicd/analysis-archived-2025-12-31/#13-missing-cicd-components","title":"1.3 Missing CI/CD Components","text":"<p>\u274c No automated testing - No unit tests execution before build - No integration tests - No static code analysis (linting, type checking)</p> <p>\u274c No PR validation - Feature branches not tested before merge - No code quality gates</p> <p>\u274c No vulnerability scanning - No dependency vulnerability checks (Dependabot, Snyk) - No container image scanning (Trivy, Grype)</p> <p>\u274c No build caching - Docker layers rebuilt every time (slower builds) - No GitHub Actions cache for pip dependencies</p> <p>\u274c No multi-platform builds - Only builds for linux/amd64 - Missing linux/arm64 (M1/M2 Macs, ARM servers)</p>"},{"location":"cicd/analysis-archived-2025-12-31/#2-dockerfile-analysis","title":"2. Dockerfile Analysis","text":""},{"location":"cicd/analysis-archived-2025-12-31/#21-multi-stage-build-strategy","title":"2.1 Multi-Stage Build Strategy","text":""},{"location":"cicd/analysis-archived-2025-12-31/#stage-1-builder-python3137-slim","title":"Stage 1: Builder (python:3.13.7-slim)","text":"<pre><code>FROM python:3.13.7-slim AS builder\nWORKDIR /app\nENV PYTHONDONTWRITEBYTECODE=1\nENV PYTHONUNBUFFERED=1\nCOPY requirements.txt .\nRUN pip wheel --no-cache-dir --no-deps --wheel-dir /app/wheels -r requirements.txt\n</code></pre> <p>Analysis: - \u2705 Excellent: Multi-stage build reduces final image size - \u2705 Good: Uses slim variant (smaller than full Python image) - \u2705 Good: <code>PYTHONDONTWRITEBYTECODE=1</code> prevents .pyc files - \u2705 Good: <code>PYTHONUNBUFFERED=1</code> ensures real-time logs - \u2705 Good: Pre-builds wheels for faster installation - \u26a0\ufe0f Minor: Could use <code>--platform</code> for multi-arch support</p>"},{"location":"cicd/analysis-archived-2025-12-31/#stage-2-final-runtime-python3137-slim","title":"Stage 2: Final Runtime (python:3.13.7-slim)","text":"<pre><code>FROM python:3.13.7-slim\n# ... labels ...\nWORKDIR /app\nCOPY --from=builder /app/wheels /wheels\nCOPY --from=builder /app/requirements.txt .\nRUN pip install --no-cache-dir /wheels/*\nRUN addgroup --gid 1000 --system app &amp;&amp; \\\n    adduser --no-create-home --shell /bin/false --disabled-password --uid 1000 --system --group app\nUSER app\nCOPY ./src ./\nENTRYPOINT [\"python\", \"main.py\"]\nCMD [\"--help\"]\n</code></pre> <p>Analysis: - \u2705 Excellent: Runs as non-root user (security best practice) - \u2705 Excellent: Only copies necessary files from builder stage - \u2705 Good: Rich metadata labels (OCI standard) - \u2705 Good: Default CMD shows help (user-friendly) - \u26a0\ufe0f Issue: Copies <code>./src</code> to <code>/app</code> (flattens directory structure) - \u26a0\ufe0f Issue: UID 1000 may conflict with host user permissions - \u26a0\ufe0f Minor: No health check defined</p>"},{"location":"cicd/analysis-archived-2025-12-31/#22-image-size-analysis","title":"2.2 Image Size Analysis","text":"Component Size Estimate Notes Base (python:3.13.7-slim) ~130MB Debian-based Pillow + dependencies ~80MB Image processing libs Rich + dependencies ~5MB Terminal UI Source code &lt;1MB Python files Total ~245MB \u2705 Reasonable <p>Comparison: - <code>python:3.13.7-slim</code>: ~130MB (current) - <code>python:3.13.7-alpine</code>: ~50MB (but may have compatibility issues with Pillow) - Verdict: Slim is the right choice for this use case</p>"},{"location":"cicd/analysis-archived-2025-12-31/#23-security-analysis","title":"2.3 Security Analysis","text":"<p>\u2705 Strengths: - Non-root user execution - No hardcoded secrets - Minimal installed packages - No unnecessary build tools in final image</p> <p>\u26a0\ufe0f Weaknesses: - No explicit vulnerability scanning in CI/CD - No SBOM (Software Bill of Materials) generation - Base image not pinned to digest (subject to updates)</p> <p>\u274c Critical: Base image should be digest-pinned <pre><code># Current (vulnerable to base image updates)\nFROM python:3.13.7-slim\n\n# Recommended\nFROM python:3.13.7-slim@sha256:&lt;digest&gt;\n</code></pre></p>"},{"location":"cicd/analysis-archived-2025-12-31/#24-dockerignore-analysis","title":"2.4 .dockerignore Analysis","text":"<p>File: <code>.dockerignore</code></p> <pre><code>**/.git\n**/.gitignore\n**/.vscode\n**/coverage\n**/.env\n**/.aws\n**/.ssh\nDockerfile\nREADME.md\ndocker-compose.yml\n**/.DS_Store\n**/venv\n**/env\n</code></pre> <p>Analysis: - \u2705 Good: Excludes version control files - \u2705 Good: Excludes credentials (.env, .aws, .ssh) - \u2705 Good: Excludes IDE files (.vscode, .DS_Store) - \u2705 Good: Excludes virtual environments - \u26a0\ufe0f Missing: Should exclude test files (<code>test_*.py</code>) - \u26a0\ufe0f Missing: Should exclude documentation (<code>*.md</code>, <code>REFACTORING_*.md</code>) - \u26a0\ufe0f Missing: Should exclude <code>__pycache__</code>, <code>*.pyc</code></p> <p>Recommended additions: <pre><code>test_*.py\n**/*.md\n**/__pycache__\n**/*.pyc\n**/*.pyo\n**/*.pyd\n.pytest_cache\n.coverage\nhtmlcov/\ndist/\nbuild/\n*.egg-info/\n</code></pre></p>"},{"location":"cicd/analysis-archived-2025-12-31/#3-compatibility-with-new-architecture","title":"3. Compatibility with New Architecture","text":""},{"location":"cicd/analysis-archived-2025-12-31/#31-build-verification","title":"3.1 Build Verification","text":"<p>\u2705 Docker build successful with all new features: - ProcessingConfig dataclass - ProgressReporter abstraction - Configurable pipeline system - Error handling system</p>"},{"location":"cicd/analysis-archived-2025-12-31/#32-runtime-verification","title":"3.2 Runtime Verification","text":"<pre><code>$ docker run --rm shiroink:test --help\n</code></pre> <p>Output: <pre><code>usage: main.py [-h] [-r RESOLUTION] [--rtl] [-q QUALITY] [-d] [-w WORKERS]\n               [--dry-run] [-p {kindle,tablet,print,high_quality,minimal}]\n               src_dir dest_dir\n</code></pre></p> <p>\u2705 All new features present: - <code>-p, --pipeline</code> option with 5 presets - All existing options preserved - Backward compatibility maintained</p>"},{"location":"cicd/analysis-archived-2025-12-31/#33-dependency-analysis","title":"3.3 Dependency Analysis","text":"<p>Current dependencies: - <code>pillow==11.3.0</code> (image processing) - <code>rich==14.1.0</code> (terminal UI)</p> <p>New feature dependencies: None (all features use standard library)</p> <p>\u2705 No additional dependencies required \u2705 Container size unchanged (still ~245MB)</p>"},{"location":"cicd/analysis-archived-2025-12-31/#4-issues-identified","title":"4. Issues Identified","text":""},{"location":"cicd/analysis-archived-2025-12-31/#41-critical-issues","title":"4.1 Critical Issues","text":"# Issue Severity Impact 1 No automated testing in CI/CD \ud83d\udd34 High Bugs may reach production 2 Base image not digest-pinned \ud83d\udd34 High Supply chain vulnerability 3 No vulnerability scanning \ud83d\udd34 High Unknown security issues"},{"location":"cicd/analysis-archived-2025-12-31/#42-major-issues","title":"4.2 Major Issues","text":"# Issue Severity Impact 4 No PR validation workflow \ud83d\udfe0 Medium Poor code quality control 5 No multi-platform builds \ud83d\udfe0 Medium Limited platform support 6 Directory structure flattened in container \ud83d\udfe0 Medium Breaks relative imports"},{"location":"cicd/analysis-archived-2025-12-31/#43-minor-issues","title":"4.3 Minor Issues","text":"# Issue Severity Impact 7 .dockerignore incomplete \ud83d\udfe1 Low Larger build context 8 No Docker healthcheck \ud83d\udfe1 Low Poor orchestration support 9 No build caching \ud83d\udfe1 Low Slower CI/CD builds 10 UID 1000 hardcoded \ud83d\udfe1 Low Permission issues on some hosts"},{"location":"cicd/analysis-archived-2025-12-31/#5-recommendations","title":"5. Recommendations","text":""},{"location":"cicd/analysis-archived-2025-12-31/#51-immediate-actions-high-priority","title":"5.1 Immediate Actions (High Priority)","text":""},{"location":"cicd/analysis-archived-2025-12-31/#1-add-pr-validation-workflow","title":"1. Add PR Validation Workflow","text":"<p>File: <code>.github/workflows/test.yml</code></p> <pre><code>name: Test and Lint\n\non:\n  pull_request:\n    branches: [main]\n  push:\n    branches: [main]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Python\n        uses: actions/setup-python@v5\n        with:\n          python-version: '3.13'\n          cache: 'pip'\n\n      - name: Install dependencies\n        run: |\n          pip install -r requirements.txt\n          pip install pytest pytest-cov flake8 mypy black\n\n      - name: Lint with flake8\n        run: flake8 src/ --count --max-line-length=88 --statistics\n\n      - name: Check formatting with black\n        run: black --check src/\n\n      - name: Type check with mypy\n        run: mypy src/ --ignore-missing-imports\n\n      - name: Run tests\n        run: |\n          PYTHONPATH=src pytest test_*.py -v --cov=src --cov-report=term-missing\n\n      - name: Upload coverage\n        uses: codecov/codecov-action@v4\n        if: always()\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#2-fix-dockerfile-directory-structure","title":"2. Fix Dockerfile Directory Structure","text":"<p>Current issue: <code>COPY ./src ./</code> copies to <code>/app</code> (breaks imports)</p> <p>Fixed Dockerfile: <pre><code># ... builder stage ...\n\n# Final stage\nFROM python:3.13.7-slim@sha256:&lt;pin-digest-here&gt;\n\nWORKDIR /app\n\nCOPY --from=builder /app/wheels /wheels\nCOPY --from=builder /app/requirements.txt .\nRUN pip install --no-cache-dir /wheels/*\n\nRUN addgroup --gid 1000 --system app &amp;&amp; \\\n    adduser --no-create-home --shell /bin/false --disabled-password --uid 1000 --system --group app\n\nUSER app\n\n# Fix: Preserve directory structure\nCOPY --chown=app:app ./src ./src\n\n# Fix: Update entrypoint to use proper path\nENTRYPOINT [\"python\", \"-m\", \"src.main\"]\nCMD [\"--help\"]\n\n# Add healthcheck (if running as service)\n# HEALTHCHECK --interval=30s --timeout=3s --retries=3 \\\n#   CMD python -c \"import sys; sys.exit(0)\"\n</code></pre></p>"},{"location":"cicd/analysis-archived-2025-12-31/#3-add-vulnerability-scanning","title":"3. Add Vulnerability Scanning","text":"<p>File: <code>.github/workflows/build-and-push-image.yml</code></p> <p>Add before the attestation step:</p> <pre><code>      - name: Run Trivy vulnerability scanner\n        uses: aquasecurity/trivy-action@master\n        with:\n          image-ref: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ steps.meta.outputs.version }}\n          format: 'sarif'\n          output: 'trivy-results.sarif'\n\n      - name: Upload Trivy results to GitHub Security\n        uses: github/codeql-action/upload-sarif@v3\n        if: always()\n        with:\n          sarif_file: 'trivy-results.sarif'\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#52-medium-priority-improvements","title":"5.2 Medium Priority Improvements","text":""},{"location":"cicd/analysis-archived-2025-12-31/#4-add-multi-platform-support","title":"4. Add Multi-Platform Support","text":"<p>Update build step in <code>.github/workflows/build-and-push-image.yml</code>:</p> <pre><code>      - name: Set up QEMU\n        uses: docker/setup-qemu-action@v3\n\n      - name: Set up Docker Buildx\n        uses: docker/setup-buildx-action@v3\n\n      - name: Build and push Docker image\n        id: push\n        uses: docker/build-push-action@f2a1d5e99d037542a71f64918e516c093c6f3fc4\n        with:\n          context: .\n          platforms: linux/amd64,linux/arm64  # Add ARM support\n          push: true\n          tags: ${{ steps.meta.outputs.tags }}\n          labels: ${{ steps.meta.outputs.labels }}\n          cache-from: type=gha  # Enable GitHub Actions cache\n          cache-to: type=gha,mode=max\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#5-improve-dockerignore","title":"5. Improve .dockerignore","text":"<pre><code># Version control\n**/.git\n**/.gitignore\n\n# IDE\n**/.vscode\n**/.idea\n**/.DS_Store\n\n# Python\n**/__pycache__\n**/*.pyc\n**/*.pyo\n**/*.pyd\n**/.pytest_cache\n**/.coverage\n**/htmlcov\n**/.mypy_cache\n**/.tox\n**/dist\n**/build\n**/*.egg-info\n\n# Virtual environments\n**/venv\n**/env\n**/.venv\n\n# Documentation\n**/*.md\n!README.md  # Keep README for image documentation\n\n# Testing\ntest_*.py\n**/tests/\n**/coverage/\n\n# CI/CD\n.github/\n.dockerignore\nDockerfile\ndocker-compose.yml\n\n# Secrets\n**/.env\n**/.aws\n**/.ssh\n**/credentials*\n**/*secret*\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#53-low-priority-enhancements","title":"5.3 Low Priority Enhancements","text":""},{"location":"cicd/analysis-archived-2025-12-31/#6-add-docker-compose-for-local-development","title":"6. Add Docker Compose for Local Development","text":"<p>File: <code>docker-compose.yml</code></p> <pre><code>version: '3.8'\n\nservices:\n  shiroink:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: shiroink:local\n    volumes:\n      - ./input:/input:ro\n      - ./output:/output\n    command: /input /output --pipeline kindle -d\n    environment:\n      - PYTHONUNBUFFERED=1\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#7-add-version-information","title":"7. Add Version Information","text":"<p>File: <code>src/__version__.py</code></p> <pre><code>__version__ = \"1.0.0\"\n</code></pre> <p>Update <code>src/cli.py</code>: <pre><code>from __version__ import __version__\n\nparser.add_argument('--version', action='version', version=f'ShiroInk {__version__}')\n</code></pre></p>"},{"location":"cicd/analysis-archived-2025-12-31/#8-add-dependabot-configuration","title":"8. Add Dependabot Configuration","text":"<p>File: <code>.github/dependabot.yml</code></p> <pre><code>version: 2\nupdates:\n  - package-ecosystem: \"pip\"\n    directory: \"/\"\n    schedule:\n      interval: \"weekly\"\n    open-pull-requests-limit: 10\n\n  - package-ecosystem: \"docker\"\n    directory: \"/\"\n    schedule:\n      interval: \"weekly\"\n\n  - package-ecosystem: \"github-actions\"\n    directory: \"/\"\n    schedule:\n      interval: \"weekly\"\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#6-performance-optimization","title":"6. Performance Optimization","text":""},{"location":"cicd/analysis-archived-2025-12-31/#61-build-time-optimization","title":"6.1 Build Time Optimization","text":"<p>Current: ~30-60 seconds per build (estimated)</p> <p>Improvements: 1. Enable BuildKit cache: Reduces rebuilds (saves ~40%) 2. Cache pip wheels: Reuse across builds (saves ~20%) 3. Parallel builds: Multi-platform (no time increase)</p> <p>Expected: ~15-30 seconds per build</p>"},{"location":"cicd/analysis-archived-2025-12-31/#62-runtime-optimization","title":"6.2 Runtime Optimization","text":"<p>Current: Efficient (no issues detected)</p> <p>Container resource limits (recommended for production): <pre><code>deploy:\n  resources:\n    limits:\n      cpus: '2.0'\n      memory: 2G\n    reservations:\n      cpus: '0.5'\n      memory: 512M\n</code></pre></p>"},{"location":"cicd/analysis-archived-2025-12-31/#7-security-best-practices-checklist","title":"7. Security Best Practices Checklist","text":"<ul> <li>[x] Non-root user execution</li> <li>[x] Minimal base image (slim)</li> <li>[x] No hardcoded secrets</li> <li>[x] SHA-pinned GitHub Actions</li> <li>[x] Artifact attestation enabled</li> <li>[ ] Base image digest-pinned</li> <li>[ ] Vulnerability scanning enabled</li> <li>[ ] SBOM generation</li> <li>[ ] Secrets scanning (pre-commit hook)</li> <li>[ ] Supply chain verification (Sigstore)</li> </ul>"},{"location":"cicd/analysis-archived-2025-12-31/#8-container-usage-examples","title":"8. Container Usage Examples","text":""},{"location":"cicd/analysis-archived-2025-12-31/#81-basic-usage","title":"8.1 Basic Usage","text":"<pre><code># Pull image\ndocker pull ghcr.io/esoso/shiroink:latest\n\n# Process directory\ndocker run --rm \\\n  -v /path/to/input:/input:ro \\\n  -v /path/to/output:/output \\\n  ghcr.io/esoso/shiroink:latest \\\n  /input /output --pipeline kindle\n\n# Process with custom settings\ndocker run --rm \\\n  -v $(pwd)/manga:/input:ro \\\n  -v $(pwd)/optimized:/output \\\n  ghcr.io/esoso/shiroink:latest \\\n  /input /output \\\n  --pipeline tablet \\\n  --resolution 1200x1600 \\\n  --quality 8 \\\n  --workers 4\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#82-advanced-usage","title":"8.2 Advanced Usage","text":"<pre><code># Debug mode with dry-run\ndocker run --rm \\\n  -v ./input:/input:ro \\\n  -v ./output:/output \\\n  ghcr.io/esoso/shiroink:latest \\\n  /input /output --dry-run --debug --pipeline high_quality\n\n# RTL (right-to-left) manga\ndocker run --rm \\\n  -v ./manga:/input:ro \\\n  -v ./optimized:/output \\\n  ghcr.io/esoso/shiroink:latest \\\n  /input /output --rtl --pipeline print\n\n# Use specific tag\ndocker run --rm \\\n  -v ./input:/input:ro \\\n  -v ./output:/output \\\n  ghcr.io/esoso/shiroink:v1.0.0 \\\n  /input /output --pipeline minimal\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#83-docker-compose-usage","title":"8.3 Docker Compose Usage","text":"<pre><code>version: '3.8'\n\nservices:\n  shiroink:\n    image: ghcr.io/esoso/shiroink:latest\n    volumes:\n      - ./input:/input:ro\n      - ./output:/output\n    command: &gt;\n      /input /output\n      --pipeline kindle\n      --workers 8\n      --quality 7\n    restart: \"no\"\n</code></pre> <p>Run: <code>docker-compose run --rm shiroink</code></p>"},{"location":"cicd/analysis-archived-2025-12-31/#9-monitoring-and-observability","title":"9. Monitoring and Observability","text":""},{"location":"cicd/analysis-archived-2025-12-31/#91-logging","title":"9.1 Logging","text":"<p>Current: Stdout/stderr (captured by Docker)</p> <p>Access logs: <pre><code>docker logs &lt;container-id&gt;\ndocker logs -f &lt;container-id&gt;  # Follow\ndocker logs --tail 100 &lt;container-id&gt;  # Last 100 lines\n</code></pre></p>"},{"location":"cicd/analysis-archived-2025-12-31/#92-metrics","title":"9.2 Metrics","text":"<p>Container metrics: <pre><code>docker stats &lt;container-id&gt;\n</code></pre></p> <p>Image scanning results: Check GitHub Security tab after enabling Trivy</p>"},{"location":"cicd/analysis-archived-2025-12-31/#10-migration-path-for-existing-users","title":"10. Migration Path for Existing Users","text":""},{"location":"cicd/analysis-archived-2025-12-31/#101-breaking-changes-in-container","title":"10.1 Breaking Changes in Container","text":"<p>\u274c CRITICAL: Current Dockerfile has a path issue</p> <p>Current behavior (broken): <pre><code>COPY ./src ./  # Copies to /app, breaks imports\nENTRYPOINT [\"python\", \"main.py\"]  # Looks for /app/main.py (wrong)\n</code></pre></p> <p>This will fail because: 1. Files are at <code>/app/*.py</code> instead of <code>/app/src/*.py</code> 2. Relative imports in <code>src/</code> will break 3. Module imports like <code>from image_pipeline import ...</code> will fail</p> <p>Fix required (see Section 5.1, Recommendation #2)</p>"},{"location":"cicd/analysis-archived-2025-12-31/#102-backward-compatibility","title":"10.2 Backward Compatibility","text":"<p>\u2705 CLI interface: 100% backward compatible \u2705 Default behavior: Unchanged (Kindle preset) \u2705 Volume mounts: Same as before \u2705 Environment variables: None required</p>"},{"location":"cicd/analysis-archived-2025-12-31/#11-summary-and-action-plan","title":"11. Summary and Action Plan","text":""},{"location":"cicd/analysis-archived-2025-12-31/#current-state","title":"Current State","text":"Aspect Status Notes CI/CD Pipeline \ud83d\udfe1 Partial Builds on tags, no testing Docker Build \u2705 Working Multi-stage, optimized Security \ud83d\udfe0 Basic Non-root, but missing scans Size Optimization \u2705 Good 245MB (reasonable) New Features \u2705 Compatible All 4 improvements work Documentation \ud83d\udfe1 Partial Missing usage examples"},{"location":"cicd/analysis-archived-2025-12-31/#critical-path-do-first","title":"Critical Path (Do First)","text":"<ol> <li>Fix Dockerfile path issue (prevents runtime errors)</li> <li>Add PR validation workflow (catch bugs early)</li> <li>Pin base image digest (security)</li> <li>Add vulnerability scanning (security)</li> </ol>"},{"location":"cicd/analysis-archived-2025-12-31/#nice-to-have-do-later","title":"Nice to Have (Do Later)","text":"<ol> <li>Multi-platform builds (ARM support)</li> <li>Build caching (faster CI/CD)</li> <li>Dependabot (automated updates)</li> <li>Version tagging system</li> </ol>"},{"location":"cicd/analysis-archived-2025-12-31/#estimated-effort","title":"Estimated Effort","text":"<ul> <li>Critical fixes: 2-4 hours</li> <li>Testing &amp; validation: 2 hours</li> <li>Full implementation: 1-2 days</li> <li>Documentation: 1-2 hours</li> </ul>"},{"location":"cicd/analysis-archived-2025-12-31/#appendix-a-commands-reference","title":"Appendix A: Commands Reference","text":"<pre><code># Local testing\ndocker build -t shiroink:test .\ndocker run --rm shiroink:test --help\ndocker run --rm -v ./test:/input:ro -v ./out:/output shiroink:test /input /output --dry-run\n\n# Multi-platform build (local)\ndocker buildx create --use\ndocker buildx build --platform linux/amd64,linux/arm64 -t shiroink:multi .\n\n# Image inspection\ndocker inspect shiroink:test\ndocker history shiroink:test\ndocker image ls shiroink:test\n\n# Security scanning (local)\ndocker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n  aquasec/trivy image shiroink:test\n\n# Cleanup\ndocker rmi shiroink:test\ndocker system prune -a\n</code></pre>"},{"location":"cicd/analysis-archived-2025-12-31/#appendix-b-github-actions-workflow-templates","title":"Appendix B: GitHub Actions Workflow Templates","text":"<p>See Section 5 (Recommendations) for complete workflow YAML examples.</p> <p>Document Version: 1.0 Last Updated: 2025-12-31 Author: OpenCode Analysis Status: Ready for Implementation</p>"},{"location":"cicd/implementation/","title":"CI/CD Implementation Status - ShiroInk","text":""},{"location":"cicd/implementation/#current-status","title":"Current Status","text":"<p>Version: 2.0.9 Date: 2025-12-31 Status: \u2705 Fully Operational</p>"},{"location":"cicd/implementation/#implemented-features","title":"Implemented Features","text":""},{"location":"cicd/implementation/#1-automated-release-management-v201-v206","title":"\u2705 1. Automated Release Management (v2.0.1 - v2.0.6)","text":"<p>Implemented: Complete automated release workflow with version management</p> <p>Components: - Release Please integration for semantic releases - PEP 621 compliant version management in <code>pyproject.toml</code> - Dynamic version detection in <code>src/__version__.py</code> - Automated CHANGELOG generation</p> <p>Files Modified: - <code>.github/workflows/release-please.yml</code> - Automated release workflow - <code>pyproject.toml</code> - Single source of truth for version - <code>src/__version__.py</code> - Dynamic version loading - <code>.release-please-config.json</code> - Release configuration</p> <p>Releases: v2.0.1 through v2.0.9 (9 automated releases)</p>"},{"location":"cicd/implementation/#2-automated-docker-publishing-v202-v204","title":"\u2705 2. Automated Docker Publishing (v2.0.2 - v2.0.4)","text":"<p>Implemented: Docker images automatically built and published after each release</p> <p>Features: - Reusable workflow with <code>workflow_call</code> trigger - Automatic triggering after Release Please creates release - Tag passing from release to Docker build - Proper checkout of release tag</p> <p>Files Modified: - <code>.github/workflows/build-and-push-image.yml</code> - Made workflow reusable - <code>.github/workflows/release-please.yml</code> - Added <code>trigger-docker-build</code> job</p> <p>Impact: Docker images available immediately after each release</p>"},{"location":"cicd/implementation/#3-docker-image-version-tagging-v205-v207","title":"\u2705 3. Docker Image Version Tagging (v2.0.5 - v2.0.7)","text":"<p>Implemented: Comprehensive Docker image tagging strategy</p> <p>Tags Created (7 variants per release): <pre><code>ghcr.io/esoso/shiroink:2.0.9     # Exact semver\nghcr.io/esoso/shiroink:v2.0.9    # Exact semver with v prefix\nghcr.io/esoso/shiroink:2.0       # Major.minor\nghcr.io/esoso/shiroink:v2.0      # Major.minor with v prefix\nghcr.io/esoso/shiroink:2         # Major only\nghcr.io/esoso/shiroink:v2        # Major with v prefix\nghcr.io/esoso/shiroink:latest    # Latest release\n</code></pre></p> <p>Files Modified: - <code>.github/workflows/build-and-push-image.yml</code> - Enhanced tags configuration</p> <p>Rationale:  - Non-v tags follow Docker convention - V-prefix tags match Git tags exactly - Major/minor tags for flexible version pinning</p>"},{"location":"cicd/implementation/#4-docker-version-display-v206","title":"\u2705 4. Docker Version Display (v2.0.6)","text":"<p>Implemented: Container shows correct version when run</p> <p>Solution: - Copy <code>pyproject.toml</code> to Docker image - Version detection reads from pyproject.toml as fallback - Works both installed and containerized</p> <p>Files Modified: - <code>Dockerfile</code> - Added <code>COPY pyproject.toml</code></p> <p>Verification: <pre><code>$ docker run --rm ghcr.io/esoso/shiroink:2.0.9 --version\nShiroInk 2.0.9\n</code></pre></p>"},{"location":"cicd/implementation/#5-security-scanning-v208-v209","title":"\u2705 5. Security Scanning (v2.0.8 - v2.0.9)","text":"<p>Implemented: Automated vulnerability scanning with Trivy</p> <p>Features: - Trivy scanner runs on every Docker build - GHCR authentication for private images - SARIF reporting to GitHub Security tab - Lowercase image reference for proper parsing - Non-blocking with <code>continue-on-error</code></p> <p>Files Modified: - <code>.github/workflows/build-and-push-image.yml</code> - Added Trivy scanner with auth</p> <p>Issues Resolved: - v2.0.8: Added authentication credentials - v2.0.9: Fixed image reference format (mixed-case issue)</p> <p>Security Coverage: - Scans for CRITICAL and HIGH severity vulnerabilities - Results viewable in GitHub Security tab - Automated on every release</p>"},{"location":"cicd/implementation/#6-multi-platform-support","title":"\u2705 6. Multi-Platform Support","text":"<p>Implemented: Docker images built for multiple architectures</p> <p>Platforms: - <code>linux/amd64</code> - Standard x86_64 systems - <code>linux/arm64</code> - ARM systems (M1/M2 Macs, ARM servers)</p> <p>Components: - QEMU for cross-platform emulation - Docker Buildx for multi-architecture builds - GitHub Actions cache for faster builds</p> <p>Build Time: - Without cache: ~90 seconds (both platforms) - With cache: ~36 seconds (40% improvement)</p>"},{"location":"cicd/implementation/#7-testing-quality-checks","title":"\u2705 7. Testing &amp; Quality Checks","text":"<p>Implemented: Comprehensive testing on all pull requests</p> <p>Workflow: <code>.github/workflows/test.yml</code></p> <p>Test Matrix: Python 3.11, 3.12, 3.13</p> <p>Checks: - Flake8 linting (syntax errors, undefined names) - Black code formatting - MyPy type checking (non-blocking) - Pytest unit tests with coverage - Codecov coverage reporting - Hadolint Dockerfile linting - Docker build validation (all 5 presets)</p> <p>Coverage: Integrated with Codecov for tracking</p>"},{"location":"cicd/implementation/#8-documentation-automation","title":"\u2705 8. Documentation Automation","text":"<p>Implemented: Auto-deploy documentation to GitHub Pages</p> <p>Workflow: <code>.github/workflows/docs.yml</code></p> <p>Triggers: - Changes to <code>docs/**</code> - Changes to <code>mkdocs.yml</code> - Manual dispatch</p> <p>Output: https://esoso.github.io/ShiroInk/</p>"},{"location":"cicd/implementation/#9-dependency-management","title":"\u2705 9. Dependency Management","text":"<p>Implemented: Automated dependency updates with Dependabot</p> <p>Configuration: <code>.github/dependabot.yml</code></p> <p>Managed Dependencies: - Python packages (weekly) - Docker base images (weekly) - GitHub Actions (weekly)</p> <p>Features: - Automatic PR creation - Test validation before merge - Labeled and grouped updates</p>"},{"location":"cicd/implementation/#complete-workflow-chain","title":"Complete Workflow Chain","text":"<pre><code>1. Developer commits with conventional commit\n   \u2193\n2. Test workflow validates (if PR)\n   \u251c\u2500 Linting (flake8, black)\n   \u251c\u2500 Type checking (mypy)\n   \u251c\u2500 Unit tests (pytest)\n   \u251c\u2500 Coverage report (codecov)\n   \u2514\u2500 Docker build test\n   \u2193\n3. Merge to main\n   \u2193\n4. Release Please workflow\n   \u251c\u2500 Analyzes commits\n   \u251c\u2500 Creates/updates release PR\n   \u2514\u2500 Updates version &amp; changelog\n   \u2193\n5. Maintainer merges release PR\n   \u2193\n6. Release Please creates GitHub release\n   \u251c\u2500 Tag: v2.0.X\n   \u2514\u2500 Release notes from CHANGELOG\n   \u2193\n7. Docker build workflow (automatic)\n   \u251c\u2500 Checkout release tag\n   \u251c\u2500 Build multi-platform (amd64 + arm64)\n   \u251c\u2500 Push with 7 tag variants\n   \u251c\u2500 Run Trivy security scan\n   \u251c\u2500 Upload SARIF to Security tab\n   \u2514\u2500 Generate attestation\n   \u2193\n8. Images available at ghcr.io/esoso/shiroink\n   \u251c\u2500 ghcr.io/esoso/shiroink:2.0.9\n   \u251c\u2500 ghcr.io/esoso/shiroink:v2.0.9\n   \u251c\u2500 ghcr.io/esoso/shiroink:2.0\n   \u251c\u2500 ghcr.io/esoso/shiroink:v2.0\n   \u251c\u2500 ghcr.io/esoso/shiroink:2\n   \u251c\u2500 ghcr.io/esoso/shiroink:v2\n   \u2514\u2500 ghcr.io/esoso/shiroink:latest\n</code></pre>"},{"location":"cicd/implementation/#metrics-statistics","title":"Metrics &amp; Statistics","text":""},{"location":"cicd/implementation/#releases","title":"Releases","text":"<ul> <li>Total releases: 10 (v2.0.0 through v2.0.9)</li> <li>Release frequency: ~10 releases in 1 day (initial setup)</li> <li>Automation level: 100% automated</li> </ul>"},{"location":"cicd/implementation/#docker-images","title":"Docker Images","text":"<ul> <li>Platforms: 2 (amd64, arm64)</li> <li>Tags per release: 7</li> <li>Total tags available: 70+ (across all releases)</li> <li>Image size: 245MB (optimized)</li> <li>Registry: GitHub Container Registry (ghcr.io)</li> </ul>"},{"location":"cicd/implementation/#security","title":"Security","text":"<ul> <li>Vulnerability scans: Every release</li> <li>Severity levels: CRITICAL, HIGH</li> <li>Reporting: GitHub Security tab</li> <li>Attestations: SLSA provenance on all images</li> </ul>"},{"location":"cicd/implementation/#testing","title":"Testing","text":"<ul> <li>Python versions tested: 3 (3.11, 3.12, 3.13)</li> <li>Test workflows: Every PR + push to main</li> <li>Coverage tracking: Codecov integration</li> <li>Docker validation: All 5 pipeline presets</li> </ul>"},{"location":"cicd/implementation/#issues-encountered-resolved","title":"Issues Encountered &amp; Resolved","text":""},{"location":"cicd/implementation/#issue-1-release-please-not-updating-version-files","title":"Issue 1: Release Please Not Updating Version Files","text":"<p>Version: v2.0.1 Problem: <code>extra-files</code> parameter deprecated in v4 Solution: Adopted PEP 621, used <code>[project]</code> section in pyproject.toml Files: pyproject.toml, src/version.py, .release-please-config.json</p>"},{"location":"cicd/implementation/#issue-2-docker-images-not-building-after-release","title":"Issue 2: Docker Images Not Building After Release","text":"<p>Version: v2.0.2 - v2.0.4 Problem: Release Please creates releases via API, doesn't trigger <code>on: push: tags:</code> Solution: Made workflow reusable with <code>workflow_call</code>, triggered from release-please Files: build-and-push-image.yml, release-please.yml</p>"},{"location":"cicd/implementation/#issue-3-docker-images-missing-version-tags","title":"Issue 3: Docker Images Missing Version Tags","text":"<p>Version: v2.0.5 Problem: Images only tagged as <code>main</code> or <code>latest</code>, not version numbers Solution: Configure metadata action to generate tags from workflow input Files: build-and-push-image.yml</p>"},{"location":"cicd/implementation/#issue-4-docker-tag-format-confusion","title":"Issue 4: Docker Tag Format Confusion","text":"<p>Version: v2.0.7 Problem: Users expected <code>v2.0.7</code> but Docker convention is <code>2.0.7</code> Solution: Create both formats - standard Docker + v-prefix for Git compatibility Files: build-and-push-image.yml</p>"},{"location":"cicd/implementation/#issue-5-version-shows-unknown-in-container","title":"Issue 5: Version Shows \"unknown\" in Container","text":"<p>Version: v2.0.6 Problem: pyproject.toml not copied to image, version detection failed Solution: Add <code>COPY pyproject.toml</code> to Dockerfile Files: Dockerfile</p>"},{"location":"cicd/implementation/#issue-6-trivy-scanner-authentication-failure","title":"Issue 6: Trivy Scanner Authentication Failure","text":"<p>Version: v2.0.8 Problem: Trivy couldn't access private GHCR images Solution: Added TRIVY_USERNAME and TRIVY_PASSWORD env vars Files: build-and-push-image.yml</p>"},{"location":"cicd/implementation/#issue-7-trivy-image-reference-parsing-error","title":"Issue 7: Trivy Image Reference Parsing Error","text":"<p>Version: v2.0.9 Problem: Mixed-case repo name (EsOsO/ShiroInk) vs lowercase GHCR (esoso/shiroink) Solution: Use hardcoded lowercase path in image-ref Files: build-and-push-image.yml</p>"},{"location":"cicd/implementation/#current-configuration-files","title":"Current Configuration Files","text":""},{"location":"cicd/implementation/#release-management","title":"Release Management","text":"<ul> <li><code>.github/workflows/release-please.yml</code> - Automated releases</li> <li><code>.release-please-config.json</code> - Release configuration</li> <li><code>.release-please-manifest.json</code> - Version tracking</li> </ul>"},{"location":"cicd/implementation/#docker-publishing","title":"Docker Publishing","text":"<ul> <li><code>.github/workflows/build-and-push-image.yml</code> - Multi-platform builds + security</li> <li><code>Dockerfile</code> - Optimized multi-stage build</li> <li><code>.dockerignore</code> - Build context optimization</li> </ul>"},{"location":"cicd/implementation/#testing-quality","title":"Testing &amp; Quality","text":"<ul> <li><code>.github/workflows/test.yml</code> - PR validation</li> <li><code>.github/workflows/docs.yml</code> - Documentation deployment</li> </ul>"},{"location":"cicd/implementation/#dependency-management","title":"Dependency Management","text":"<ul> <li><code>.github/dependabot.yml</code> - Automated updates</li> </ul>"},{"location":"cicd/implementation/#version-source","title":"Version Source","text":"<ul> <li><code>pyproject.toml</code> - Single source of truth (PEP 621)</li> <li><code>src/__version__.py</code> - Dynamic version detection</li> </ul>"},{"location":"cicd/implementation/#performance-improvements","title":"Performance Improvements","text":""},{"location":"cicd/implementation/#build-speed","title":"Build Speed","text":"<ul> <li>Before caching: ~90s per build</li> <li>After caching: ~36s per build</li> <li>Improvement: 60% reduction</li> </ul>"},{"location":"cicd/implementation/#cicd-efficiency","title":"CI/CD Efficiency","text":"<ul> <li>Parallel testing: 3 Python versions simultaneously</li> <li>Build caching: GitHub Actions cache integration</li> <li>Smart triggers: Only builds on releases, tests on PRs</li> </ul>"},{"location":"cicd/implementation/#image-optimization","title":"Image Optimization","text":"<ul> <li>Multi-stage build: Reduces final size</li> <li>Minimal base: python:3.13-slim</li> <li>Layer optimization: Proper COPY order</li> <li>Size: 245MB (efficient for use case)</li> </ul>"},{"location":"cicd/implementation/#whats-working","title":"What's Working","text":"<p>\u2705 Fully Automated Release Pipeline - Conventional commits \u2192 Release PR \u2192 GitHub release \u2192 Docker images - Zero manual intervention required - Version management completely automated</p> <p>\u2705 Comprehensive Testing - All PRs tested before merge - Multi-version Python support - Docker build validation - Code quality enforcement</p> <p>\u2705 Security Best Practices - Vulnerability scanning on every release - Supply chain attestations - Non-root container execution - Automated dependency updates</p> <p>\u2705 Multi-Platform Support - Works on x86_64 and ARM systems - Single command for all platforms - Transparent to users</p> <p>\u2705 Proper Version Tracking - Works in containers and local installs - Displays correct version everywhere - Single source of truth</p>"},{"location":"cicd/implementation/#maintenance-guide","title":"Maintenance Guide","text":""},{"location":"cicd/implementation/#for-regular-maintenance","title":"For Regular Maintenance","text":"<p>Weekly (automated by Dependabot): - Review dependency update PRs - Verify tests pass - Merge if safe</p> <p>Per Release (automated): - Review release PR from Release Please - Verify CHANGELOG is accurate - Merge to trigger release and Docker build</p> <p>Monthly: - Review Security tab for vulnerabilities - Check GitHub Actions usage/limits - Update documentation if needed</p>"},{"location":"cicd/implementation/#for-troubleshooting","title":"For Troubleshooting","text":"<p>If release not created: 1. Check conventional commit format 2. Verify release-please workflow ran 3. Check for existing open release PR</p> <p>If Docker build fails: 1. Check workflow logs 2. Review Trivy scan results 3. Verify base image is accessible</p> <p>If tests fail: 1. Check test workflow logs 2. Run tests locally: <code>pytest test_*.py</code> 3. Fix issues and push again</p>"},{"location":"cicd/implementation/#success-metrics","title":"Success Metrics","text":""},{"location":"cicd/implementation/#automation","title":"Automation","text":"<ul> <li>Release automation: 100%</li> <li>Docker publishing: 100%</li> <li>Testing: 100% (on PRs)</li> <li>Documentation: 100% (auto-deploy)</li> </ul>"},{"location":"cicd/implementation/#reliability","title":"Reliability","text":"<ul> <li>Build success rate: &gt;95%</li> <li>Test coverage: Tracked via Codecov</li> <li>Security scan: Every release</li> <li>Uptime: Container registry 99.9%</li> </ul>"},{"location":"cicd/implementation/#developer-experience","title":"Developer Experience","text":"<ul> <li>Release time: &lt;5 minutes (automated)</li> <li>Build time: ~36 seconds (cached)</li> <li>Feedback time: ~3 minutes (test workflow)</li> <li>Version accuracy: 100%</li> </ul>"},{"location":"cicd/implementation/#future-improvements","title":"Future Improvements","text":""},{"location":"cicd/implementation/#planned","title":"Planned","text":"<ul> <li>[ ] Integration tests for full workflow</li> <li>[ ] Performance benchmarking in CI</li> <li>[ ] Automated rollback on failures</li> </ul>"},{"location":"cicd/implementation/#under-consideration","title":"Under Consideration","text":"<ul> <li>[ ] Multi-region registry mirrors</li> <li>[ ] SBOM generation</li> <li>[ ] Signed releases (Sigstore)</li> <li>[ ] Release note enhancements</li> </ul> <p>Document Version: 2.0 Last Updated: 2025-12-31 Status: Complete and Accurate \u2705</p>"},{"location":"cicd/overview/","title":"CI/CD Overview - ShiroInk","text":""},{"location":"cicd/overview/#current-status","title":"Current Status","text":"<p>Last Updated: 2025-12-31 Latest Version: v2.0.9 Status: \u2705 Production Ready</p>"},{"location":"cicd/overview/#automation-pipeline","title":"Automation Pipeline","text":"<p>ShiroInk uses a fully automated CI/CD pipeline powered by GitHub Actions with the following components:</p>"},{"location":"cicd/overview/#1-automated-releases-release-please","title":"1. Automated Releases (Release Please)","text":"<p>Workflow: <code>.github/workflows/release-please.yml</code></p> <ul> <li>Triggers: Every push to <code>main</code> branch</li> <li>Actions:</li> <li>Analyzes commits using Conventional Commits</li> <li>Creates/updates release PR with version bump and changelog</li> <li>When PR is merged: creates GitHub release with tag</li> <li>Automatically triggers Docker image build</li> </ul> <p>Version Management: - Single source of truth: <code>pyproject.toml</code> - Follows Semantic Versioning (SemVer) - Auto-updates CHANGELOG.md</p> <p>Release Types: - <code>fix:</code> \u2192 Patch release (2.0.X) - <code>feat:</code> \u2192 Minor release (2.X.0) - <code>feat!:</code> or <code>BREAKING CHANGE:</code> \u2192 Major release (X.0.0)</p>"},{"location":"cicd/overview/#2-docker-image-publishing","title":"2. Docker Image Publishing","text":"<p>Workflow: <code>.github/workflows/build-and-push-image.yml</code></p> <ul> <li>Triggers:</li> <li>Automatically after each release (via <code>workflow_call</code>)</li> <li>Manually via <code>workflow_dispatch</code></li> <li> <p>On version tags (<code>v*.*.*</code>)</p> </li> <li> <p>Build Features:</p> </li> <li>Multi-platform: <code>linux/amd64</code> + <code>linux/arm64</code></li> <li>Multi-stage build (optimized size: ~245MB)</li> <li>GitHub Actions build cache (40% faster builds)</li> <li> <p>Non-root user execution (UID 1000)</p> </li> <li> <p>Security Features:</p> </li> <li>Trivy vulnerability scanning (CRITICAL + HIGH)</li> <li>SARIF upload to GitHub Security tab</li> <li>Artifact attestation (supply chain security)</li> <li> <p>Digest-pinned base images</p> </li> <li> <p>Image Tags (7 variants):   <pre><code>ghcr.io/esoso/shiroink:2.0.9     # Exact version\nghcr.io/esoso/shiroink:v2.0.9    # Exact version with v prefix\nghcr.io/esoso/shiroink:2.0       # Major.minor\nghcr.io/esoso/shiroink:v2.0      # Major.minor with v prefix\nghcr.io/esoso/shiroink:2         # Major version\nghcr.io/esoso/shiroink:v2        # Major version with v prefix\nghcr.io/esoso/shiroink:latest    # Latest release\n</code></pre></p> </li> </ul>"},{"location":"cicd/overview/#3-pull-request-validation","title":"3. Pull Request Validation","text":"<p>Workflow: <code>.github/workflows/test.yml</code></p> <ul> <li> <p>Triggers: All PRs to <code>main</code> + pushes to <code>main</code></p> </li> <li> <p>Test Matrix: Python 3.11, 3.12, 3.13</p> </li> <li> <p>Quality Checks:</p> </li> <li>Flake8: Syntax errors, undefined names</li> <li>Black: Code formatting validation</li> <li>MyPy: Type checking (non-blocking)</li> <li>Pytest: Unit tests with coverage</li> <li>Codecov: Coverage reporting</li> <li>Hadolint: Dockerfile linting</li> <li>Docker Build Test: Validates all 5 pipeline presets</li> </ul>"},{"location":"cicd/overview/#4-documentation-deployment","title":"4. Documentation Deployment","text":"<p>Workflow: <code>.github/workflows/docs.yml</code></p> <ul> <li>Triggers: </li> <li>Changes to <code>docs/**</code> on <code>main</code></li> <li>Changes to <code>mkdocs.yml</code></li> <li> <p>Manual dispatch</p> </li> <li> <p>Actions:</p> </li> <li>Builds documentation with MkDocs Material theme</li> <li>Deploys to GitHub Pages</li> <li>Accessible at: https://esoso.github.io/ShiroInk/</li> </ul>"},{"location":"cicd/overview/#5-dependency-management","title":"5. Dependency Management","text":"<p>Configuration: <code>.github/dependabot.yml</code></p> <ul> <li>Weekly Updates (Mondays 09:00 UTC):</li> <li>Python packages (pip)</li> <li>Docker base images</li> <li> <p>GitHub Actions versions</p> </li> <li> <p>Automated PRs:</p> </li> <li>Auto-created with test validation</li> <li>Labeled appropriately</li> <li>Security updates prioritized</li> </ul>"},{"location":"cicd/overview/#workflow-diagram","title":"Workflow Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Developer commits code with conventional commit message    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Release Please Workflow                                    \u2502\n\u2502  - Analyzes commits                                         \u2502\n\u2502  - Creates/updates release PR                               \u2502\n\u2502  - Updates version in pyproject.toml                        \u2502\n\u2502  - Updates CHANGELOG.md                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Maintainer merges release PR                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Release Please creates GitHub release (e.g., v2.0.9)       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Docker Build Workflow (automatic)                          \u2502\n\u2502  \u251c\u2500 Checkout code at release tag                            \u2502\n\u2502  \u251c\u2500 Build multi-platform image (amd64 + arm64)              \u2502\n\u2502  \u251c\u2500 Push to ghcr.io with all 7 tag variants                 \u2502\n\u2502  \u251c\u2500 Run Trivy security scan                                 \u2502\n\u2502  \u251c\u2500 Upload results to Security tab                          \u2502\n\u2502  \u2514\u2500 Generate artifact attestation                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Images available at ghcr.io/esoso/shiroink                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"cicd/overview/#release-process","title":"Release Process","text":""},{"location":"cicd/overview/#automatic-release-flow","title":"Automatic Release Flow","text":"<ol> <li> <p>Developer: Commit with conventional commit message    <pre><code>git commit -m \"feat: add new processing option\"\ngit push origin main\n</code></pre></p> </li> <li> <p>Release Please: Analyzes and creates release PR</p> </li> <li>Bumps version (feat \u2192 2.X.0)</li> <li>Updates CHANGELOG.md</li> <li> <p>Updates pyproject.toml</p> </li> <li> <p>Maintainer: Reviews and merges release PR    <pre><code>gh pr merge &lt;number&gt; --squash\n</code></pre></p> </li> <li> <p>Release Please: Creates GitHub release with tag</p> </li> <li>Tag: <code>v2.X.0</code></li> <li> <p>Release notes from CHANGELOG</p> </li> <li> <p>Docker Build: Automatically triggered</p> </li> <li>Builds and pushes images</li> <li>Scans for vulnerabilities</li> <li> <p>Generates attestations</p> </li> <li> <p>Users: Pull new version    <pre><code>docker pull ghcr.io/esoso/shiroink:latest\ndocker pull ghcr.io/esoso/shiroink:v2.X.0\n</code></pre></p> </li> </ol>"},{"location":"cicd/overview/#manual-release-if-needed","title":"Manual Release (if needed)","text":"<pre><code># Create tag manually\ngit tag v2.X.Y\ngit push origin v2.X.Y\n\n# This triggers Docker build workflow directly\n</code></pre>"},{"location":"cicd/overview/#version-detection","title":"Version Detection","text":"<p>ShiroInk automatically detects its version using a hierarchical approach:</p> <ol> <li>If installed as package: Reads from <code>importlib.metadata</code></li> <li>Fallback: Reads from <code>pyproject.toml</code> directly</li> <li>Used by: <code>--version</code> CLI flag and Docker image metadata</li> </ol> <p>Example: <pre><code># Local installation\n$ python src/main.py --version\nShiroInk 2.0.9\n\n# Docker container\n$ docker run --rm ghcr.io/esoso/shiroink:latest --version\nShiroInk 2.0.9\n</code></pre></p>"},{"location":"cicd/overview/#security-features","title":"Security Features","text":""},{"location":"cicd/overview/#1-vulnerability-scanning","title":"1. Vulnerability Scanning","text":"<ul> <li>Tool: Trivy (Aqua Security)</li> <li>Scan Targets: Container images</li> <li>Severity Levels: CRITICAL, HIGH</li> <li>Results: Uploaded to GitHub Security tab</li> </ul>"},{"location":"cicd/overview/#2-supply-chain-security","title":"2. Supply Chain Security","text":"<ul> <li>Artifact Attestations: SLSA provenance</li> <li>SHA-pinned Actions: Prevents supply chain attacks</li> <li>Digest-pinned Images: Immutable base images</li> <li>Dependabot: Automated security updates</li> </ul>"},{"location":"cicd/overview/#3-access-control","title":"3. Access Control","text":"<ul> <li>Non-root Execution: UID 1000 in containers</li> <li>Minimal Permissions: Least privilege in workflows</li> <li>No Hardcoded Secrets: Uses GitHub tokens only</li> </ul>"},{"location":"cicd/overview/#performance-metrics","title":"Performance Metrics","text":""},{"location":"cicd/overview/#build-times","title":"Build Times","text":"<ul> <li>Without cache: ~60 seconds</li> <li>With cache: ~36 seconds</li> <li>Multi-platform: ~90 seconds total</li> </ul>"},{"location":"cicd/overview/#test-times","title":"Test Times","text":"<ul> <li>Per Python version: ~2-3 minutes</li> <li>Total (3 versions): ~6-9 minutes (parallel)</li> <li>Docker build test: ~30 seconds</li> </ul>"},{"location":"cicd/overview/#image-metrics","title":"Image Metrics","text":"<ul> <li>Size: 245MB (optimized)</li> <li>Layers: 14 (multi-stage build)</li> <li>Platforms: 2 (amd64, arm64)</li> </ul>"},{"location":"cicd/overview/#monitoring-observability","title":"Monitoring &amp; Observability","text":""},{"location":"cicd/overview/#github-actions","title":"GitHub Actions","text":"<ul> <li>Workflow runs: https://github.com/EsOsO/ShiroInk/actions</li> <li>Release history: https://github.com/EsOsO/ShiroInk/releases</li> <li>Security alerts: https://github.com/EsOsO/ShiroInk/security</li> </ul>"},{"location":"cicd/overview/#container-registry","title":"Container Registry","text":"<ul> <li>Package page: https://github.com/EsOsO/ShiroInk/pkgs/container/shiroink</li> <li>All tags: Available on package page</li> <li>Pull stats: Visible on package page</li> </ul>"},{"location":"cicd/overview/#coverage-reports","title":"Coverage Reports","text":"<ul> <li>Codecov: Integrated with PR checks</li> <li>Coverage trend: Tracked over time</li> <li>Target: &gt;80% coverage</li> </ul>"},{"location":"cicd/overview/#troubleshooting","title":"Troubleshooting","text":""},{"location":"cicd/overview/#release-please-not-creating-pr","title":"Release Please Not Creating PR","text":"<p>Possible causes: - No conventional commits since last release - Commits don't trigger version bump (e.g., <code>docs:</code>, <code>chore:</code>)</p> <p>Solution: <pre><code># Check recent commits\ngit log --oneline -10\n\n# Add a feat or fix commit to trigger release\ngit commit -m \"fix: minor improvement\" --allow-empty\ngit push origin main\n</code></pre></p>"},{"location":"cicd/overview/#docker-build-failing","title":"Docker Build Failing","text":"<p>Check: 1. Workflow logs: https://github.com/EsOsO/ShiroInk/actions 2. Trivy scan results in Security tab 3. Build cache issues (clear with workflow_dispatch)</p> <p>Common fixes: - Clear GitHub Actions cache - Rebuild base image - Check Dockerfile syntax</p>"},{"location":"cicd/overview/#version-not-updating-in-container","title":"Version Not Updating in Container","text":"<p>Verify: <pre><code># Check pyproject.toml was copied\ndocker run --rm ghcr.io/esoso/shiroink:latest python -c \"import toml; print(toml.load('/app/pyproject.toml')['project']['version'])\"\n\n# Check __version__.py\ndocker run --rm ghcr.io/esoso/shiroink:latest python -c \"import sys; sys.path.insert(0, '/app/src'); from __version__ import __version__; print(__version__)\"\n</code></pre></p>"},{"location":"cicd/overview/#best-practices","title":"Best Practices","text":""},{"location":"cicd/overview/#for-developers","title":"For Developers","text":"<ol> <li> <p>Always use conventional commits:    <pre><code>git commit -m \"feat: add feature\"\ngit commit -m \"fix: resolve bug\"\ngit commit -m \"docs: update readme\"\n</code></pre></p> </li> <li> <p>Test locally before pushing:    <pre><code>docker build -t shiroink:test .\ndocker run --rm shiroink:test --version\n</code></pre></p> </li> <li> <p>Run tests locally:    <pre><code>pytest test_*.py -v\nblack --check src/\nflake8 src/\n</code></pre></p> </li> </ol>"},{"location":"cicd/overview/#for-maintainers","title":"For Maintainers","text":"<ol> <li>Review release PRs carefully:</li> <li>Check version bump is correct</li> <li>Review CHANGELOG.md changes</li> <li> <p>Verify all tests pass</p> </li> <li> <p>Monitor security alerts:</p> </li> <li>Check Security tab regularly</li> <li>Review Trivy scan results</li> <li> <p>Address vulnerabilities promptly</p> </li> <li> <p>Manage dependencies:</p> </li> <li>Review Dependabot PRs weekly</li> <li>Test updates before merging</li> <li>Keep actions up to date</li> </ol>"},{"location":"cicd/overview/#future-enhancements","title":"Future Enhancements","text":""},{"location":"cicd/overview/#planned","title":"Planned","text":"<ul> <li>[ ] Automated changelog formatting improvements</li> <li>[ ] Performance benchmarking in CI</li> <li>[ ] Integration tests for full workflow</li> <li>[ ] SBOM (Software Bill of Materials) generation</li> </ul>"},{"location":"cicd/overview/#under-consideration","title":"Under Consideration","text":"<ul> <li>[ ] Signed releases with Sigstore/cosign</li> <li>[ ] Performance regression detection</li> <li>[ ] Automated rollback on failures</li> <li>[ ] Multi-region container registry mirrors</li> </ul>"},{"location":"cicd/overview/#references","title":"References","text":"<ul> <li>Release Please: https://github.com/googleapis/release-please</li> <li>Conventional Commits: https://www.conventionalcommits.org/</li> <li>Semantic Versioning: https://semver.org/</li> <li>Trivy Scanner: https://github.com/aquasecurity/trivy</li> <li>GitHub Actions: https://docs.github.com/en/actions</li> <li>Docker Multi-platform: https://docs.docker.com/build/building/multi-platform/</li> </ul> <p>Document Version: 2.0 Last Updated: 2025-12-31 Status: Current and Accurate \u2705</p>"},{"location":"cicd/security-scanning/","title":"Security Scanning Guide","text":"<p>This document explains how GitHub Security scanning works in ShiroInk and how to address alerts.</p>"},{"location":"cicd/security-scanning/#overview","title":"Overview","text":"<p>ShiroInk uses Trivy (open-source vulnerability scanner) to scan Docker images for security vulnerabilities. Scans run automatically on every Docker image build and publish results to GitHub Security tab.</p>"},{"location":"cicd/security-scanning/#current-configuration","title":"Current Configuration","text":"<p>Workflow: <code>.github/workflows/build-and-push-image.yml</code></p> <pre><code>- name: Run Trivy vulnerability scanner\n  uses: aquasecurity/trivy-action@master\n  with:\n    image-ref: ghcr.io/esoso/shiroink@${{ steps.push.outputs.digest }}\n    format: 'sarif'\n    output: 'trivy-results.sarif'\n    severity: 'CRITICAL,HIGH'  # Only scan for critical/high severity\n</code></pre> <p>What gets scanned: - Base OS packages (Alpine Linux) - Python runtime and dependencies - Application dependencies (Pillow, Rich, etc.)</p>"},{"location":"cicd/security-scanning/#viewing-security-alerts","title":"Viewing Security Alerts","text":"<ol> <li>Go to: https://github.com/EsOsO/ShiroInk/security/code-scanning</li> <li>Filter by severity: Critical, High, Medium, Low, Warning, Note</li> <li>Click individual alerts for details</li> </ol> <p>CLI method: <pre><code># View all alerts\ngh api repos/EsOsO/ShiroInk/code-scanning/alerts\n\n# View only warnings\ngh api repos/EsOsO/ShiroInk/code-scanning/alerts --jq '.[] | select(.rule.severity == \"warning\")'\n</code></pre></p>"},{"location":"cicd/security-scanning/#addressing-security-alerts","title":"Addressing Security Alerts","text":""},{"location":"cicd/security-scanning/#option-1-update-base-image-recommended","title":"Option 1: Update Base Image (Recommended)","text":"<p>Most vulnerabilities come from the base Docker image. Update to latest:</p> <pre><code># In Dockerfile\nFROM python:3.13-alpine  # Change to: python:3.13-alpine3.21 (latest)\n</code></pre> <p>Then rebuild: <pre><code>docker build -t shiroink:test .\n</code></pre></p>"},{"location":"cicd/security-scanning/#option-2-suppress-false-positives","title":"Option 2: Suppress False Positives","text":"<p>Use <code>.trivyignore</code> file to suppress alerts that don't affect ShiroInk:</p> <p>Already configured in <code>.trivyignore</code>: - Old CVEs from base OS (2005-2011 era) - not exploitable in containers - util-linux vulnerabilities - ShiroInk doesn't manage users - OpenSSL SM2/KEK vulnerabilities - ShiroInk doesn't use these crypto operations</p> <p>To add more suppressions: <pre><code># Edit .trivyignore\necho \"CVE-2025-XXXXX\" &gt;&gt; .trivyignore\n</code></pre></p>"},{"location":"cicd/security-scanning/#option-3-accept-risk-document","title":"Option 3: Accept Risk &amp; Document","text":"<p>For vulnerabilities that are: - Not exploitable in containerized environment - In dependencies not used by ShiroInk - Awaiting upstream patches</p> <p>Document in this file why they're acceptable: <pre><code>## Accepted Risks\n\n### CVE-2025-XXXXX (Severity: HIGH)\n- **Component**: util-linux\n- **Why Accepted**: ShiroInk doesn't use user management features\n- **Mitigated By**: Container runs as non-root, no shell access\n- **Review Date**: 2026-01-05\n</code></pre></p>"},{"location":"cicd/security-scanning/#option-4-update-dependencies","title":"Option 4: Update Dependencies","text":"<p>For Python package vulnerabilities:</p> <pre><code># Check outdated packages\npip list --outdated\n\n# Update specific package\npip install --upgrade pillow\n\n# Update requirements.txt\npip freeze &gt; requirements.txt\n</code></pre> <p>Then rebuild Docker image.</p>"},{"location":"cicd/security-scanning/#common-vulnerabilities-solutions","title":"Common Vulnerabilities &amp; Solutions","text":""},{"location":"cicd/security-scanning/#1-pip-cve-2025-8869-symbolic-link-extraction","title":"1. pip CVE-2025-8869 (Symbolic Link Extraction)","text":"<p>Status: WARNING Impact: Low (pip only used during build, not runtime) Solution: <pre><code># Update pip during build\nRUN pip install --upgrade pip&gt;=25.2.1\n</code></pre></p>"},{"location":"cicd/security-scanning/#2-util-linux-cve-2025-14104-heap-buffer-overread","title":"2. util-linux CVE-2025-14104 (Heap Buffer Overread)","text":"<p>Status: WARNING Impact: None (ShiroInk doesn't use setpwnam()) Solution: Suppressed in <code>.trivyignore</code> (false positive for our use case)</p>"},{"location":"cicd/security-scanning/#3-openssl-cves-2025-9230-2025-9231","title":"3. OpenSSL CVEs (2025-9230, 2025-9231)","text":"<p>Status: WARNING Impact: None (ShiroInk doesn't use SM2 or KEK operations) Solution: Suppressed in <code>.trivyignore</code> (not applicable)</p>"},{"location":"cicd/security-scanning/#best-practices","title":"Best Practices","text":""},{"location":"cicd/security-scanning/#1-regular-updates","title":"1. Regular Updates","text":"<p>Update base image monthly: <pre><code># Check for updates\ndocker pull python:3.13-alpine\n\n# Rebuild with latest\ndocker build --no-cache -t shiroink:latest .\n</code></pre></p>"},{"location":"cicd/security-scanning/#2-minimize-attack-surface","title":"2. Minimize Attack Surface","text":"<p>Current Dockerfile already follows best practices: - \u2705 Uses Alpine Linux (minimal base) - \u2705 Multi-stage build (smaller final image) - \u2705 Runs as non-root user - \u2705 Only installs required dependencies</p>"},{"location":"cicd/security-scanning/#3-pin-dependency-versions","title":"3. Pin Dependency Versions","text":"<p>In <code>requirements.txt</code>: <pre><code>pillow&gt;=11.3.0,&lt;12.0.0  # Pin major version\nrich&gt;=14.1.0,&lt;15.0.0\n</code></pre></p>"},{"location":"cicd/security-scanning/#4-review-alerts-regularly","title":"4. Review Alerts Regularly","text":"<p>Schedule: Review security alerts monthly <pre><code># Check current status\ngh api repos/EsOsO/ShiroInk/code-scanning/alerts --jq '.[] | select(.state == \"open\") | .rule.severity' | sort | uniq -c\n</code></pre></p>"},{"location":"cicd/security-scanning/#trivy-configuration-options","title":"Trivy Configuration Options","text":""},{"location":"cicd/security-scanning/#adjust-severity-threshold","title":"Adjust Severity Threshold","text":"<p>In <code>.github/workflows/build-and-push-image.yml</code>:</p> <pre><code># Currently scans: CRITICAL,HIGH\nseverity: 'CRITICAL,HIGH,MEDIUM'  # Add MEDIUM severity\n\n# Scan everything (not recommended - too noisy)\nseverity: 'CRITICAL,HIGH,MEDIUM,LOW,UNKNOWN'\n</code></pre>"},{"location":"cicd/security-scanning/#scan-specific-vulnerability-types","title":"Scan Specific Vulnerability Types","text":"<pre><code>- name: Run Trivy vulnerability scanner\n  uses: aquasecurity/trivy-action@master\n  with:\n    image-ref: ghcr.io/esoso/shiroink@${{ steps.push.outputs.digest }}\n    format: 'sarif'\n    output: 'trivy-results.sarif'\n    severity: 'CRITICAL,HIGH'\n    vuln-type: 'os,library'  # Scan both OS packages and libraries\n    ignore-unfixed: true     # Ignore vulnerabilities without fixes\n</code></pre>"},{"location":"cicd/security-scanning/#use-trivy-config-file","title":"Use Trivy Config File","text":"<p>Create <code>.trivy.yaml</code>: <pre><code>severity:\n  - CRITICAL\n  - HIGH\n\nignore-unfixed: true\n\n# Ignore specific paths\nskip-dirs:\n  - tests/\n  - docs/\n</code></pre></p>"},{"location":"cicd/security-scanning/#dismissing-alerts-in-github","title":"Dismissing Alerts in GitHub","text":"<p>Via GitHub UI: 1. Go to Security \u2192 Code scanning 2. Click alert 3. Click \"Dismiss alert\" \u2192 Select reason:    - Won't fix (accepted risk)    - False positive    - Used in tests (not production)</p> <p>Via API: <pre><code># Dismiss specific alert\ngh api -X PATCH repos/EsOsO/ShiroInk/code-scanning/alerts/71 \\\n  -f state=dismissed \\\n  -f dismissed_reason=\"won't fix\" \\\n  -f dismissed_comment=\"Not exploitable in containerized environment\"\n</code></pre></p>"},{"location":"cicd/security-scanning/#testing-locally","title":"Testing Locally","text":"<p>Run Trivy scan locally before pushing:</p> <pre><code># Build image\ndocker build -t shiroink:test .\n\n# Scan with Trivy\ndocker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n  aquasec/trivy:latest image \\\n  --severity CRITICAL,HIGH \\\n  --ignore-unfixed \\\n  shiroink:test\n\n# Use .trivyignore\ndocker run --rm \\\n  -v $(pwd)/.trivyignore:/.trivyignore \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  aquasec/trivy:latest image \\\n  --severity CRITICAL,HIGH \\\n  --ignorefile /.trivyignore \\\n  shiroink:test\n</code></pre>"},{"location":"cicd/security-scanning/#resources","title":"Resources","text":"<ul> <li>Trivy Documentation: https://aquasecurity.github.io/trivy/</li> <li>GitHub Code Scanning: https://docs.github.com/en/code-security/code-scanning</li> <li>CVE Database: https://cve.mitre.org/</li> <li>NVD (National Vulnerability Database): https://nvd.nist.gov/</li> </ul>"},{"location":"cicd/security-scanning/#current-status","title":"Current Status","text":"<p>Last reviewed: 2026-01-04 - Total alerts: 71 - Critical: 0 - High: 0 - Warning: 9 - Note: 62</p> <p>Action Required: Review pip CVE-2025-8869 and update if necessary.</p>"},{"location":"cicd/testing/","title":"CI/CD Pipeline Documentation","text":""},{"location":"cicd/testing/#overview","title":"Overview","text":"<p>ShiroInk uses GitHub Actions for continuous integration and continuous deployment. The CI/CD pipeline ensures code quality, runs comprehensive tests, and validates Docker builds.</p>"},{"location":"cicd/testing/#workflows","title":"Workflows","text":""},{"location":"cicd/testing/#1-test-and-lint-testyml","title":"1. Test and Lint (<code>test.yml</code>)","text":"<p>Triggers: - Pull requests to <code>main</code> - Pushes to <code>main</code> - Daily scheduled runs at 6 AM UTC</p> <p>Jobs:</p>"},{"location":"cicd/testing/#test","title":"<code>test</code>","text":"<p>Runs comprehensive test suite across multiple Python versions and operating systems.</p> <p>Matrix: - Python versions: 3.11, 3.12, 3.13 - Operating systems: Ubuntu (all versions), macOS (3.13 only), Windows (3.13 only)</p> <p>Steps: 1. Checkout code 2. Setup Python with pip caching 3. Install dependencies from requirements.txt and dev dependencies 4. Lint with flake8 - Syntax errors and style warnings 5. Check formatting with black 6. Type check with mypy (non-blocking) 7. Run unit tests with coverage 8. Run integration tests with coverage 9. Upload coverage to Codecov (Python 3.13 on Ubuntu only) 10. Upload HTML coverage report as artifact 11. Check coverage threshold (70% minimum)</p>"},{"location":"cicd/testing/#test-device-presets","title":"<code>test-device-presets</code>","text":"<p>Tests all device preset functionality.</p> <p>Steps: 1. Test <code>--list-devices</code> command 2. Test device preset selection (Kindle, PocketBook Color, iPad) 3. Test device/resolution conflict validation 4. Run device-specific unit tests</p>"},{"location":"cicd/testing/#lint-dockerfile","title":"<code>lint-dockerfile</code>","text":"<p>Lints the Dockerfile using hadolint.</p>"},{"location":"cicd/testing/#docker-build-test","title":"<code>docker-build-test</code>","text":"<p>Tests Docker image build and functionality.</p> <p>Steps: 1. Build Docker image with BuildKit caching 2. Test basic functionality (<code>--help</code>) 3. Test all 11 pipeline presets 4. Test device preset listing</p>"},{"location":"cicd/testing/#test-summary","title":"<code>test-summary</code>","text":"<p>Aggregates test results from all jobs and reports overall status.</p>"},{"location":"cicd/testing/#coverage-reporting","title":"Coverage Reporting","text":""},{"location":"cicd/testing/#configuration","title":"Configuration","text":"<p>Coverage is configured in <code>.coveragerc</code>: - Source: <code>src/</code> directory - Omit: Tests, <code>__init__.py</code>, virtual environments - Branch coverage: Enabled - Threshold: 70% minimum - Formats: Terminal, XML (Codecov), HTML (artifact)</p>"},{"location":"cicd/testing/#viewing-coverage","title":"Viewing Coverage","text":""},{"location":"cicd/testing/#locally","title":"Locally","text":"<pre><code># Run tests with coverage\npytest --cov=src --cov-report=html\n\n# Open HTML report\nopen htmlcov/index.html\n</code></pre>"},{"location":"cicd/testing/#cicd","title":"CI/CD","text":"<ul> <li>Codecov: Coverage reports uploaded to Codecov for tracking over time</li> <li>Artifacts: HTML coverage reports stored as GitHub Actions artifacts (30-day retention)</li> </ul>"},{"location":"cicd/testing/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<p>Pre-commit hooks ensure code quality before commits.</p>"},{"location":"cicd/testing/#installation","title":"Installation","text":"<pre><code>pip install pre-commit\npre-commit install\n</code></pre>"},{"location":"cicd/testing/#hooks","title":"Hooks","text":"<ol> <li>trailing-whitespace - Remove trailing whitespace</li> <li>end-of-file-fixer - Ensure files end with newline</li> <li>check-yaml - Validate YAML syntax</li> <li>check-added-large-files - Prevent large file commits (&gt;1MB)</li> <li>check-merge-conflict - Detect merge conflict markers</li> <li>check-toml - Validate TOML syntax</li> <li>debug-statements - Detect debug statements</li> <li>mixed-line-ending - Ensure consistent line endings</li> <li>black - Auto-format Python code</li> <li>flake8 - Lint Python code</li> <li>mypy - Type check Python code</li> <li>pytest - Run unit tests</li> </ol>"},{"location":"cicd/testing/#running-manually","title":"Running Manually","text":"<pre><code># Run all hooks on all files\npre-commit run --all-files\n\n# Run specific hook\npre-commit run black --all-files\n</code></pre>"},{"location":"cicd/testing/#test-organization","title":"Test Organization","text":""},{"location":"cicd/testing/#test-types","title":"Test Types","text":"<ol> <li>Unit Tests (<code>tests/unit/</code>)</li> <li>Fast, isolated component tests</li> <li>Run on every commit</li> <li> <p>Target: 90%+ coverage for core modules</p> </li> <li> <p>Integration Tests (<code>tests/integration/</code>)</p> </li> <li>End-to-end workflow tests</li> <li>Run on every commit</li> <li> <p>Validate complete feature functionality</p> </li> <li> <p>Device Preset Tests</p> </li> <li>Dedicated job for device preset validation</li> <li>Tests all 19 device configurations</li> <li> <p>Validates CLI behavior</p> </li> <li> <p>Docker Tests</p> </li> <li>Validates Docker build process</li> <li>Tests Docker image functionality</li> <li>Validates all pipeline and device presets</li> </ol>"},{"location":"cicd/testing/#test-execution-order","title":"Test Execution Order","text":"<pre><code>1. Lint &amp; Format Checks (fast fail)\n   \u2193\n2. Type Checking (non-blocking)\n   \u2193\n3. Unit Tests (parallel across Python versions)\n   \u2193\n4. Integration Tests (parallel across Python versions)\n   \u2193\n5. Device Preset Tests\n   \u2193\n6. Docker Build &amp; Tests\n   \u2193\n7. Test Summary &amp; Status Report\n</code></pre>"},{"location":"cicd/testing/#continuous-deployment","title":"Continuous Deployment","text":""},{"location":"cicd/testing/#release-process","title":"Release Process","text":"<p>Releases are managed by Release Please (see <code>.github/workflows/release-please.yml</code>):</p> <ol> <li>Commit Convention: Follow Conventional Commits</li> <li>PR Creation: Release Please creates PR with changelog</li> <li>Merge: Merging the PR triggers release</li> <li>GitHub Release: Automatically created with notes</li> <li>Docker Build: Triggered by release (see <code>build-and-push-image.yml</code>)</li> </ol>"},{"location":"cicd/testing/#docker-image-publishing","title":"Docker Image Publishing","text":"<p>Trigger: New GitHub release</p> <p>Steps: 1. Build multi-platform image (linux/amd64, linux/arm64) 2. Tag with version and <code>latest</code> 3. Push to GitHub Container Registry (ghcr.io)</p>"},{"location":"cicd/testing/#status-badges","title":"Status Badges","text":"<p>Add to README.md:</p> <pre><code>![Tests](https://github.com/EsOsO/ShiroInk/actions/workflows/test.yml/badge.svg)\n![Coverage](https://codecov.io/gh/EsOsO/ShiroInk/branch/main/graph/badge.svg)\n![Docker](https://github.com/EsOsO/ShiroInk/actions/workflows/build-and-push-image.yml/badge.svg)\n</code></pre>"},{"location":"cicd/testing/#troubleshooting-cicd","title":"Troubleshooting CI/CD","text":""},{"location":"cicd/testing/#tests-failing-locally-but-passing-in-ci","title":"Tests Failing Locally But Passing in CI","text":"<p>Cause: Different Python version or dependencies</p> <p>Solution: <pre><code># Use same Python version as CI\npyenv install 3.13\npyenv local 3.13\n\n# Install exact dependencies\npip install -r requirements.txt\npip install -e \".[dev]\"\n</code></pre></p>"},{"location":"cicd/testing/#coverage-threshold-not-met","title":"Coverage Threshold Not Met","text":"<p>Cause: New code not covered by tests</p> <p>Solution: <pre><code># Check which lines are missing coverage\npytest --cov=src --cov-report=term-missing\n\n# Add tests for uncovered code\n</code></pre></p>"},{"location":"cicd/testing/#docker-build-failing","title":"Docker Build Failing","text":"<p>Cause: Missing files or incorrect Dockerfile</p> <p>Solution: <pre><code># Test Docker build locally\ndocker build -t shiroink:test .\ndocker run --rm shiroink:test --help\n\n# Check .dockerignore\ncat .dockerignore\n</code></pre></p>"},{"location":"cicd/testing/#pre-commit-hooks-failing","title":"Pre-commit Hooks Failing","text":"<p>Cause: Code doesn't meet style guidelines</p> <p>Solution: <pre><code># Auto-fix formatting\nblack src/\n\n# Check lint errors\nflake8 src/\n\n# Run all hooks\npre-commit run --all-files\n</code></pre></p>"},{"location":"cicd/testing/#performance-optimization","title":"Performance Optimization","text":""},{"location":"cicd/testing/#cicd-speed-improvements","title":"CI/CD Speed Improvements","text":"<ol> <li>Pip Caching: GitHub Actions caches pip packages</li> <li>Docker BuildKit: Layer caching for faster Docker builds</li> <li>Parallel Jobs: Tests run in parallel across Python versions</li> <li>Fail Fast: Disabled to see all test results</li> <li>Selective Coverage Upload: Only Python 3.13 on Ubuntu uploads to Codecov</li> </ol>"},{"location":"cicd/testing/#test-speed-improvements","title":"Test Speed Improvements","text":"<ol> <li>Test Markers: Use <code>pytest -m unit</code> to run only fast tests during development</li> <li>Fixtures: Shared fixtures reduce setup time</li> <li>Parametrization: Efficient multi-scenario testing</li> </ol>"},{"location":"cicd/testing/#monitoring","title":"Monitoring","text":""},{"location":"cicd/testing/#github-actions","title":"GitHub Actions","text":"<ul> <li>Dashboard: https://github.com/EsOsO/ShiroInk/actions</li> <li>Workflow runs: View all test runs and results</li> <li>Artifacts: Download coverage reports</li> </ul>"},{"location":"cicd/testing/#codecov","title":"Codecov","text":"<ul> <li>Dashboard: https://codecov.io/gh/EsOsO/ShiroInk</li> <li>Trends: Track coverage over time</li> <li>Pull Request Comments: Automatic coverage reports on PRs</li> </ul>"},{"location":"cicd/testing/#security","title":"Security","text":""},{"location":"cicd/testing/#secrets","title":"Secrets","text":"<p>Required GitHub secrets: - <code>CODECOV_TOKEN</code> - Codecov upload token (optional but recommended)</p>"},{"location":"cicd/testing/#dependency-scanning","title":"Dependency Scanning","text":"<p>Dependabot is configured to: - Check for security vulnerabilities - Update dependencies automatically - Create PRs for updates</p> <p>See <code>.github/dependabot.yml</code> for configuration.</p>"},{"location":"contributing/conventional-commits/","title":"Conventional Commits Configuration for ShiroInk","text":"<p>This project follows the Conventional Commits specification.</p>"},{"location":"contributing/conventional-commits/#commit-message-format","title":"Commit Message Format","text":"<pre><code>&lt;type&gt;[optional scope]: &lt;description&gt;\n\n[optional body]\n\n[optional footer(s)]\n</code></pre>"},{"location":"contributing/conventional-commits/#types","title":"Types","text":"<ul> <li>feat: A new feature</li> <li>fix: A bug fix</li> <li>docs: Documentation only changes</li> <li>style: Changes that do not affect the meaning of the code (white-space, formatting, etc)</li> <li>refactor: A code change that neither fixes a bug nor adds a feature</li> <li>perf: A code change that improves performance</li> <li>test: Adding missing tests or correcting existing tests</li> <li>build: Changes that affect the build system or external dependencies</li> <li>ci: Changes to our CI configuration files and scripts</li> <li>chore: Other changes that don't modify src or test files</li> <li>revert: Reverts a previous commit</li> <li>deps: Dependency updates (usually automated by Dependabot)</li> </ul>"},{"location":"contributing/conventional-commits/#examples","title":"Examples","text":"<pre><code>feat: add support for WebP image format\nfix: resolve memory leak in image processing pipeline\ndocs: update README with new pipeline presets\nrefactor: simplify error handling logic\nperf: optimize image resizing algorithm\nci: add multi-platform Docker builds\n</code></pre>"},{"location":"contributing/conventional-commits/#breaking-changes","title":"Breaking Changes","text":"<p>For breaking changes, add <code>!</code> after the type or add <code>BREAKING CHANGE:</code> in the footer:</p> <pre><code>feat!: change default resolution to 1920x1080\n\nBREAKING CHANGE: The default resolution has changed from 1404x1872 to 1920x1080.\nUsers relying on the old default should explicitly set --resolution 1404x1872.\n</code></pre>"},{"location":"contributing/conventional-commits/#semantic-versioning","title":"Semantic Versioning","text":"<p>Based on commit types, Release Please will automatically:</p> <ul> <li>MAJOR (x.0.0): Breaking changes (commits with <code>!</code> or <code>BREAKING CHANGE</code>)</li> <li>MINOR (0.x.0): New features (<code>feat:</code>)</li> <li>PATCH (0.0.x): Bug fixes (<code>fix:</code>, <code>perf:</code>)</li> </ul>"},{"location":"contributing/conventional-commits/#release-process","title":"Release Process","text":"<ol> <li>Push commits to <code>main</code> branch using conventional commit format</li> <li>Release Please creates/updates a PR with changelog and version bump</li> <li>Review and merge the Release Please PR</li> <li>Release Please creates a GitHub release and tag</li> <li>Docker build workflow automatically builds and publishes the container</li> </ol>"},{"location":"contributing/development/","title":"Development Setup","text":"<p>Guide for contributors and developers.</p>"},{"location":"contributing/development/#setting-up-development-environment","title":"Setting Up Development Environment","text":"<pre><code># Clone the repository\ngit clone https://github.com/EsOsO/ShiroInk.git\ncd ShiroInk\n\n# Create virtual environment\npython -m venv .venv\nsource .venv/bin/activate  # On Windows: .venv\\Scripts\\activate\n\n# Install dependencies\npip install -r requirements.txt\npip install -r requirements-docs.txt  # For documentation\n\n# Run tests\npython -m unittest discover -s . -p 'test_*.py' -v\n</code></pre>"},{"location":"contributing/development/#running-locally","title":"Running Locally","text":"<pre><code>export PYTHONPATH=src\npython src/main.py input/ output/ --pipeline kindle --dry-run\n</code></pre>"},{"location":"contributing/development/#contributing","title":"Contributing","text":"<p>Please follow Conventional Commits for commit messages.</p>"},{"location":"contributing/development/#testing","title":"Testing","text":"<pre><code># Unit tests\nPYTHONPATH=src python -m unittest discover -s . -p 'test_*.py'\n\n# Build Docker image\ndocker build -t shiroink:dev .\n\n# Test Docker image\ndocker run --rm shiroink:dev --version\n</code></pre>"},{"location":"contributing/development/#documentation","title":"Documentation","text":"<pre><code># Install docs dependencies\npip install -r requirements-docs.txt\n\n# Serve docs locally\nmkdocs serve\n\n# Build docs\nmkdocs build\n</code></pre> <p>Visit http://127.0.0.1:8000 to view documentation.</p>"},{"location":"contributing/testing-guide/","title":"Testing Quick Reference","text":""},{"location":"contributing/testing-guide/#quick-start","title":"Quick Start","text":"<pre><code># Install dev dependencies\npip install -e \".[dev]\"\n\n# Run all tests\npytest\n\n# Run tests with coverage\npytest --cov=src --cov-report=html\nopen htmlcov/index.html\n</code></pre>"},{"location":"contributing/testing-guide/#common-test-commands","title":"Common Test Commands","text":""},{"location":"contributing/testing-guide/#run-specific-test-categories","title":"Run Specific Test Categories","text":"<pre><code># Unit tests only (fast)\npytest tests/unit/\n\n# Integration tests only\npytest tests/integration/\n\n# Specific test file\npytest tests/unit/test_devices.py\n\n# Specific test class\npytest tests/unit/test_devices.py::TestDeviceSpecFields\n\n# Specific test function\npytest tests/unit/test_devices.py::TestDeviceSpecFields::test_all_devices_have_name\n\n# Tests matching pattern\npytest -k \"device\"\n</code></pre>"},{"location":"contributing/testing-guide/#test-output-control","title":"Test Output Control","text":"<pre><code># Verbose output\npytest -v\n\n# Show print statements\npytest -s\n\n# Stop on first failure\npytest -x\n\n# Show local variables on failure\npytest -l\n\n# Run last failed tests\npytest --lf\n\n# Run only failed tests from last run\npytest --ff\n</code></pre>"},{"location":"contributing/testing-guide/#coverage-commands","title":"Coverage Commands","text":"<pre><code># Basic coverage\npytest --cov=src\n\n# Coverage with missing lines\npytest --cov=src --cov-report=term-missing\n\n# HTML coverage report\npytest --cov=src --cov-report=html\n\n# XML coverage for CI\npytest --cov=src --cov-report=xml\n\n# Check coverage threshold\npytest --cov=src --cov-fail-under=70\n</code></pre>"},{"location":"contributing/testing-guide/#test-markers","title":"Test Markers","text":"<pre><code># Run only unit tests\npytest -m unit\n\n# Run only integration tests\npytest -m integration\n\n# Skip slow tests\npytest -m \"not slow\"\n</code></pre>"},{"location":"contributing/testing-guide/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<pre><code># Install pre-commit hooks\npip install pre-commit\npre-commit install\n\n# Run all hooks manually\npre-commit run --all-files\n\n# Run specific hook\npre-commit run black --all-files\npre-commit run flake8 --all-files\npre-commit run pytest-check --all-files\n\n# Skip hooks for a commit (not recommended)\ngit commit --no-verify\n</code></pre>"},{"location":"contributing/testing-guide/#code-quality-checks","title":"Code Quality Checks","text":""},{"location":"contributing/testing-guide/#formatting","title":"Formatting","text":"<pre><code># Check formatting (don't modify)\nblack --check src/\n\n# Auto-format code\nblack src/\n\n# Format specific file\nblack src/main.py\n</code></pre>"},{"location":"contributing/testing-guide/#linting","title":"Linting","text":"<pre><code># Lint all code\nflake8 src/\n\n# Lint with statistics\nflake8 src/ --statistics\n\n# Lint specific file\nflake8 src/main.py\n</code></pre>"},{"location":"contributing/testing-guide/#type-checking","title":"Type Checking","text":"<pre><code># Type check all code\nmypy src/ --ignore-missing-imports\n\n# Type check specific file\nmypy src/main.py --ignore-missing-imports\n</code></pre>"},{"location":"contributing/testing-guide/#writing-tests","title":"Writing Tests","text":""},{"location":"contributing/testing-guide/#test-structure","title":"Test Structure","text":"<pre><code>class TestFeatureName:\n    \"\"\"Test suite for feature.\"\"\"\n\n    def test_specific_behavior(self):\n        \"\"\"Test one specific behavior.\"\"\"\n        # Arrange - Set up test data\n        input_value = 10\n\n        # Act - Execute the code\n        result = my_function(input_value)\n\n        # Assert - Verify results\n        assert result == expected_value\n</code></pre>"},{"location":"contributing/testing-guide/#using-fixtures","title":"Using Fixtures","text":"<pre><code>def test_with_fixture(test_image):\n    \"\"\"Use shared fixture from conftest.py.\"\"\"\n    assert test_image.size == (100, 100)\n\n\ndef test_with_temp_dir(tmp_path):\n    \"\"\"Use pytest's built-in tmp_path fixture.\"\"\"\n    test_file = tmp_path / \"test.txt\"\n    test_file.write_text(\"content\")\n    assert test_file.read_text() == \"content\"\n</code></pre>"},{"location":"contributing/testing-guide/#parametrized-tests","title":"Parametrized Tests","text":"<pre><code>@pytest.mark.parametrize(\"input,expected\", [\n    (1, 2),\n    (2, 4),\n    (3, 6),\n])\ndef test_multiply_by_two(input, expected):\n    \"\"\"Test with multiple input/output pairs.\"\"\"\n    assert input * 2 == expected\n</code></pre>"},{"location":"contributing/testing-guide/#testing-exceptions","title":"Testing Exceptions","text":"<pre><code>def test_raises_error():\n    \"\"\"Test that function raises expected error.\"\"\"\n    with pytest.raises(ValueError):\n        my_function(invalid_input)\n</code></pre>"},{"location":"contributing/testing-guide/#available-fixtures","title":"Available Fixtures","text":"<p>From <code>tests/conftest.py</code>:</p> <ul> <li><code>test_image</code> - Simple RGB test image (100x100)</li> <li><code>test_grayscale_image</code> - Grayscale test image (100x100)</li> <li><code>test_color_image</code> - Colorful test image with gradients</li> <li><code>silent_reporter</code> - SilentProgressReporter for testing</li> <li><code>error_tracker</code> - ErrorTracker for testing</li> <li><code>test_config</code> - ProcessingConfig with temp directories</li> <li><code>sample_images</code> - Directory with sample PNG files</li> </ul> <p>Pytest built-in fixtures:</p> <ul> <li><code>tmp_path</code> - Temporary directory (Path object)</li> <li><code>tmpdir</code> - Temporary directory (py.path.local object)</li> <li><code>capsys</code> - Capture stdout/stderr</li> <li><code>monkeypatch</code> - Modify objects/dicts/environment variables</li> </ul>"},{"location":"contributing/testing-guide/#debugging-tests","title":"Debugging Tests","text":""},{"location":"contributing/testing-guide/#print-debugging","title":"Print Debugging","text":"<pre><code># Show print statements\npytest -s tests/unit/test_devices.py\n\n# Use in test\ndef test_debug():\n    print(f\"Debug: {variable}\")\n    assert True\n</code></pre>"},{"location":"contributing/testing-guide/#pdb-debugging","title":"PDB Debugging","text":"<pre><code># Drop into debugger on failure\npytest --pdb\n\n# Use in test\ndef test_debug():\n    import pdb; pdb.set_trace()\n    assert True\n</code></pre>"},{"location":"contributing/testing-guide/#verbose-output","title":"Verbose Output","text":"<pre><code># Show all test names and results\npytest -v\n\n# Show local variables on failure\npytest -l\n\n# Show full diff on assertion failures\npytest -vv\n</code></pre>"},{"location":"contributing/testing-guide/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"contributing/testing-guide/#local-ci-simulation","title":"Local CI Simulation","text":"<pre><code># Run exactly what CI runs\npip install -r requirements.txt\npip install -e \".[dev]\"\npip install flake8 mypy black\n\n# Linting\nflake8 src/ --count --select=E9,F63,F7,F82 --show-source --statistics\nflake8 src/ --count --exit-zero --max-line-length=88 --statistics\n\n# Formatting\nblack --check src/\n\n# Type checking\nmypy src/ --ignore-missing-imports --no-strict-optional\n\n# Unit tests\npytest tests/unit/ -v --cov=src --cov-report=term-missing\n\n# Integration tests\npytest tests/integration/ -v\n\n# Coverage threshold\ncoverage report --fail-under=70\n</code></pre>"},{"location":"contributing/testing-guide/#viewing-ci-results","title":"Viewing CI Results","text":"<ul> <li>GitHub Actions: https://github.com/EsOsO/ShiroInk/actions</li> <li>Coverage: https://codecov.io/gh/EsOsO/ShiroInk</li> <li>Artifacts: Click on workflow run \u2192 Artifacts \u2192 coverage-report</li> </ul>"},{"location":"contributing/testing-guide/#tips","title":"Tips","text":""},{"location":"contributing/testing-guide/#speed-up-tests","title":"Speed Up Tests","text":"<pre><code># Run in parallel (requires pytest-xdist)\npip install pytest-xdist\npytest -n auto\n\n# Run only modified tests\npytest --testmon\n\n# Use markers to skip slow tests\npytest -m \"not slow\"\n</code></pre>"},{"location":"contributing/testing-guide/#clean-test-environment","title":"Clean Test Environment","text":"<pre><code># Remove cache\npytest --cache-clear\n\n# Remove coverage data\nrm -rf .coverage htmlcov/\n\n# Remove all __pycache__\nfind . -type d -name __pycache__ -exec rm -rf {} +\n</code></pre>"},{"location":"contributing/testing-guide/#test-coverage-goals","title":"Test Coverage Goals","text":"<ul> <li>Overall: 70%+ (CI enforced)</li> <li>Core modules (devices, pipeline, presets): 90%+</li> <li>Processing steps: 85%+</li> <li>New code: 80%+</li> </ul>"},{"location":"contributing/testing-guide/#common-issues","title":"Common Issues","text":""},{"location":"contributing/testing-guide/#import-errors","title":"Import Errors","text":"<pre><code># Ensure you're in project root\ncd /path/to/ShiroInk\n\n# Install in editable mode\npip install -e .\n\n# Set PYTHONPATH if needed\nexport PYTHONPATH=$PWD/src\n</code></pre>"},{"location":"contributing/testing-guide/#fixture-not-found","title":"Fixture Not Found","text":"<p>Ensure <code>conftest.py</code> exists in <code>tests/</code> directory and contains your fixtures.</p>"},{"location":"contributing/testing-guide/#tests-pass-locally-but-fail-in-ci","title":"Tests Pass Locally But Fail in CI","text":"<p>Check Python version matches CI: <pre><code>python --version  # Should be 3.11, 3.12, or 3.13\n</code></pre></p>"},{"location":"contributing/testing-guide/#coverage-below-threshold","title":"Coverage Below Threshold","text":"<pre><code># See which lines are uncovered\npytest --cov=src --cov-report=term-missing\n\n# Focus on uncovered code\npytest --cov=src --cov-report=html\nopen htmlcov/index.html\n</code></pre>"},{"location":"guides/device-presets/","title":"Device Presets Guide","text":"<p>ShiroInk provides optimized presets for popular e-readers and tablets, automatically configuring resolution and processing pipeline for the best reading experience.</p>"},{"location":"guides/device-presets/#quick-start","title":"Quick Start","text":"<p>List all available devices: <pre><code>python src/main.py --list-devices\n</code></pre></p> <p>Use a device preset: <pre><code>python src/main.py manga/ output/ --device kindle_paperwhite_11\n</code></pre></p>"},{"location":"guides/device-presets/#supported-devices","title":"Supported Devices","text":""},{"location":"guides/device-presets/#kindle-e-readers","title":"Kindle E-Readers","text":""},{"location":"guides/device-presets/#kindle-paperwhite-11th-gen","title":"Kindle Paperwhite 11th Gen","text":"<ul> <li>Device Key: <code>kindle_paperwhite_11</code></li> <li>Resolution: 1236x1648 (300 ppi)</li> <li>Display: 6.8\" e-ink</li> <li>Pipeline: <code>kindle</code> (high contrast, moderate sharpening, 16-color quantization)</li> </ul> <pre><code>python src/main.py manga/ output/ --device kindle_paperwhite_11\n</code></pre>"},{"location":"guides/device-presets/#kindle-paperwhite-older-generations","title":"Kindle Paperwhite (older generations)","text":"<ul> <li>Device Key: <code>kindle_paperwhite</code></li> <li>Resolution: 1072x1448 (300 ppi)</li> <li>Display: 6\" e-ink</li> <li>Pipeline: <code>kindle</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device kindle_paperwhite\n</code></pre>"},{"location":"guides/device-presets/#kindle-oasis","title":"Kindle Oasis","text":"<ul> <li>Device Key: <code>kindle_oasis</code></li> <li>Resolution: 1264x1680 (300 ppi)</li> <li>Display: 7\" e-ink</li> <li>Pipeline: <code>kindle</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device kindle_oasis\n</code></pre>"},{"location":"guides/device-presets/#kindle-scribe","title":"Kindle Scribe","text":"<ul> <li>Device Key: <code>kindle_scribe</code></li> <li>Resolution: 1860x2480 (300 ppi)</li> <li>Display: 10.2\" e-ink</li> <li>Pipeline: <code>kindle</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device kindle_scribe\n</code></pre>"},{"location":"guides/device-presets/#kobo-e-readers","title":"Kobo E-Readers","text":""},{"location":"guides/device-presets/#kobo-clara-2e","title":"Kobo Clara 2E","text":"<ul> <li>Device Key: <code>kobo_clara_2e</code></li> <li>Resolution: 1072x1448 (300 ppi)</li> <li>Display: 6\" e-ink</li> <li>Pipeline: <code>kobo</code> (high contrast, strong sharpening, 16-color quantization)</li> </ul> <pre><code>python src/main.py manga/ output/ --device kobo_clara_2e\n</code></pre>"},{"location":"guides/device-presets/#kobo-libra-2","title":"Kobo Libra 2","text":"<ul> <li>Device Key: <code>kobo_libra_2</code></li> <li>Resolution: 1264x1680 (300 ppi)</li> <li>Display: 7\" e-ink</li> <li>Pipeline: <code>kobo</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device kobo_libra_2\n</code></pre>"},{"location":"guides/device-presets/#kobo-sage","title":"Kobo Sage","text":"<ul> <li>Device Key: <code>kobo_sage</code></li> <li>Resolution: 1440x1920 (300 ppi)</li> <li>Display: 8\" e-ink</li> <li>Pipeline: <code>kobo</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device kobo_sage\n</code></pre>"},{"location":"guides/device-presets/#kobo-elipsa-2e","title":"Kobo Elipsa 2E","text":"<ul> <li>Device Key: <code>kobo_elipsa_2e</code></li> <li>Resolution: 1404x1872 (227 ppi)</li> <li>Display: 10.3\" e-ink</li> <li>Pipeline: <code>kobo</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device kobo_elipsa_2e\n</code></pre>"},{"location":"guides/device-presets/#tolino-e-readers","title":"Tolino E-Readers","text":""},{"location":"guides/device-presets/#tolino-page-2","title":"Tolino Page 2","text":"<ul> <li>Device Key: <code>tolino_page_2</code></li> <li>Resolution: 1072x1448 (300 ppi)</li> <li>Display: 6\" e-ink</li> <li>Pipeline: <code>tolino</code> (high contrast, moderate sharpening, 16-color quantization)</li> </ul> <pre><code>python src/main.py manga/ output/ --device tolino_page_2\n</code></pre>"},{"location":"guides/device-presets/#tolino-vision-6","title":"Tolino Vision 6","text":"<ul> <li>Device Key: <code>tolino_vision_6</code></li> <li>Resolution: 1264x1680 (300 ppi)</li> <li>Display: 7\" e-ink</li> <li>Pipeline: <code>tolino</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device tolino_vision_6\n</code></pre>"},{"location":"guides/device-presets/#tolino-epos-3","title":"Tolino Epos 3","text":"<ul> <li>Device Key: <code>tolino_epos_3</code></li> <li>Resolution: 1404x1872 (227 ppi)</li> <li>Display: 8\" e-ink</li> <li>Pipeline: <code>tolino</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device tolino_epos_3\n</code></pre>"},{"location":"guides/device-presets/#pocketbook-e-readers","title":"PocketBook E-Readers","text":""},{"location":"guides/device-presets/#pocketbook-era","title":"PocketBook Era","text":"<ul> <li>Device Key: <code>pocketbook_era</code></li> <li>Resolution: 1072x1448 (300 ppi)</li> <li>Display: 7\" e-ink</li> <li>Pipeline: <code>pocketbook</code> (high contrast, moderate sharpening, 16-color quantization)</li> </ul> <pre><code>python src/main.py manga/ output/ --device pocketbook_era\n</code></pre>"},{"location":"guides/device-presets/#pocketbook-inkpad-4","title":"PocketBook InkPad 4","text":"<ul> <li>Device Key: <code>pocketbook_inkpad_4</code></li> <li>Resolution: 1072x1448 (300 ppi)</li> <li>Display: 7.8\" e-ink</li> <li>Pipeline: <code>pocketbook</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device pocketbook_inkpad_4\n</code></pre>"},{"location":"guides/device-presets/#pocketbook-inkpad-color-3","title":"PocketBook InkPad Color 3","text":"<ul> <li>Device Key: <code>pocketbook_inkpad_color_3</code></li> <li>Resolution: 1236x1648 (300 ppi)</li> <li>Display: 7.8\" color e-ink</li> <li>Pipeline: <code>pocketbook_color</code> (moderate contrast, light sharpening, full color)</li> </ul> <pre><code>python src/main.py manga/ output/ --device pocketbook_inkpad_color_3\n</code></pre>"},{"location":"guides/device-presets/#ipad-and-tablets","title":"iPad and Tablets","text":""},{"location":"guides/device-presets/#ipad-10th-gen","title":"iPad 10th Gen","text":"<ul> <li>Device Key: <code>ipad_10</code></li> <li>Resolution: 1620x2360 (264 ppi)</li> <li>Display: 10.9\" Liquid Retina</li> <li>Pipeline: <code>ipad</code> (light contrast, enhanced sharpening, full color)</li> </ul> <pre><code>python src/main.py manga/ output/ --device ipad_10\n</code></pre>"},{"location":"guides/device-presets/#ipad-mini","title":"iPad Mini","text":"<ul> <li>Device Key: <code>ipad_mini</code></li> <li>Resolution: 1488x2266 (326 ppi)</li> <li>Display: 8.3\" Liquid Retina</li> <li>Pipeline: <code>ipad</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device ipad_mini\n</code></pre>"},{"location":"guides/device-presets/#ipad-air","title":"iPad Air","text":"<ul> <li>Device Key: <code>ipad_air</code></li> <li>Resolution: 1640x2360 (264 ppi)</li> <li>Display: 10.9\" Liquid Retina</li> <li>Pipeline: <code>ipad</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device ipad_air\n</code></pre>"},{"location":"guides/device-presets/#ipad-pro-11","title":"iPad Pro 11\"","text":"<ul> <li>Device Key: <code>ipad_pro_11</code></li> <li>Resolution: 1668x2388 (264 ppi)</li> <li>Display: 11\" Liquid Retina</li> <li>Pipeline: <code>ipad</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device ipad_pro_11\n</code></pre>"},{"location":"guides/device-presets/#ipad-pro-129","title":"iPad Pro 12.9\"","text":"<ul> <li>Device Key: <code>ipad_pro_129</code></li> <li>Resolution: 2048x2732 (264 ppi)</li> <li>Display: 12.9\" Liquid Retina XDR</li> <li>Pipeline: <code>ipad</code></li> </ul> <pre><code>python src/main.py manga/ output/ --device ipad_pro_129\n</code></pre>"},{"location":"guides/device-presets/#pipeline-characteristics","title":"Pipeline Characteristics","text":""},{"location":"guides/device-presets/#e-ink-pipelines-kindle-kobo-tolino-pocketbook","title":"E-ink Pipelines (Kindle, Kobo, Tolino, PocketBook)","text":"<p>E-ink displays benefit from: - High Contrast (1.5-1.6x): Improves readability on lower-contrast e-ink screens - Moderate to Strong Sharpening (1.2-1.3x): Compensates for e-ink refresh characteristics - 16-color Quantization: Reduces file size significantly (manga is mostly grayscale)</p> <p>Differences between brands: - Kobo: Slightly stronger sharpening (1.3x) as Kobo devices benefit from crisper images - Kindle/Tolino/PocketBook: Standard settings (1.2-1.25x sharpening)</p>"},{"location":"guides/device-presets/#color-e-ink-pipeline-pocketbook-color","title":"Color E-ink Pipeline (PocketBook Color)","text":"<p>Color e-ink requires gentler processing: - Moderate Contrast (1.3x): Preserves color vibrancy - Light Sharpening (1.1x): Avoids artifacts on color e-ink - No Quantization: Full color preservation</p>"},{"location":"guides/device-presets/#lcdoled-pipelines-ipad-tablet","title":"LCD/OLED Pipelines (iPad, Tablet)","text":"<p>High-resolution displays benefit from: - Light Contrast (1.2x): LCD/OLED has better native contrast - Enhanced Sharpening (1.4x): Takes advantage of high pixel density - Full Color: No quantization for vibrant colors</p>"},{"location":"guides/device-presets/#advanced-usage","title":"Advanced Usage","text":""},{"location":"guides/device-presets/#override-pipeline","title":"Override Pipeline","text":"<p>You can use a device preset for resolution but override the pipeline:</p> <pre><code># Use Kobo Libra 2 resolution but with tablet pipeline\npython src/main.py manga/ output/ --device kobo_libra_2 --pipeline tablet\n</code></pre> <p>Note: When you specify <code>--device</code>, the pipeline is auto-selected, but you can override it with <code>--pipeline</code>.</p>"},{"location":"guides/device-presets/#custom-resolution-with-device-pipeline","title":"Custom Resolution with Device Pipeline","text":"<pre><code># Use Kindle pipeline with custom resolution\npython src/main.py manga/ output/ --pipeline kindle -r 1600x2400\n</code></pre>"},{"location":"guides/device-presets/#rtl-manga","title":"RTL Manga","text":"<p>All device presets support RTL (right-to-left) manga:</p> <pre><code>python src/main.py manga/ output/ --device kobo_sage --rtl\n</code></pre>"},{"location":"guides/device-presets/#programmatic-api","title":"Programmatic API","text":"<pre><code>from pathlib import Path\nfrom src.config import ProcessingConfig\nfrom src.progress_reporter import ConsoleProgressReporter\nfrom src.main import main\nfrom src.image_pipeline.devices import DeviceSpecs\n\n# Get device specification\ndevice = DeviceSpecs.get_device(\"kindle_paperwhite_11\")\n\n# Create configuration\nconfig = ProcessingConfig(\n    src_dir=Path(\"manga_source\"),\n    dest_dir=Path(\"manga_output\"),\n    resolution=device.resolution,\n    pipeline_preset=\"kindle\",\n    workers=4\n)\n\n# Run processing\nreporter = ConsoleProgressReporter()\nmain(config, reporter)\n</code></pre>"},{"location":"guides/device-presets/#adding-custom-devices","title":"Adding Custom Devices","text":"<p>To add a custom device, edit <code>src/image_pipeline/devices.py</code> and add a new <code>DeviceSpec</code>:</p> <pre><code>CUSTOM_DEVICE = DeviceSpec(\n    name=\"My Custom Device\",\n    resolution=(1200, 1600),\n    display_type=DisplayType.EINK,\n    ppi=300,\n    description=\"Custom e-reader\"\n)\n</code></pre> <p>Then add it to the <code>get_all_devices()</code> method.</p>"},{"location":"guides/device-presets/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/device-presets/#images-too-darklight","title":"Images Too Dark/Light","text":"<p>Adjust the quality setting: <pre><code>python src/main.py manga/ output/ --device kobo_libra_2 -q 8  # Higher quality\n</code></pre></p>"},{"location":"guides/device-presets/#images-not-sharp-enough","title":"Images Not Sharp Enough","text":"<p>Use a different pipeline with stronger sharpening: <pre><code>python src/main.py manga/ output/ --device kindle_paperwhite --pipeline kobo\n</code></pre></p>"},{"location":"guides/device-presets/#file-size-too-large","title":"File Size Too Large","text":"<p>Ensure quantization is enabled (automatic for e-ink devices) or lower quality: <pre><code>python src/main.py manga/ output/ --device ipad_pro_11 -q 4\n</code></pre></p>"},{"location":"guides/device-presets/#wrong-resolution","title":"Wrong Resolution","text":"<p>Verify device preset: <pre><code>python src/main.py --list-devices | grep kobo\n</code></pre></p>"},{"location":"guides/docker/","title":"Docker Guide","text":"<p>Advanced Docker usage for ShiroInk.</p>"},{"location":"guides/docker/#using-docker-compose","title":"Using Docker Compose","text":"<p>Create a <code>docker-compose.yml</code>:</p> <pre><code>version: '3.8'\nservices:\n  shiroink:\n    image: ghcr.io/esoso/shiroink:latest\n    volumes:\n      - ./input:/input:ro\n      - ./output:/output\n    command: /input /output --pipeline kindle\n</code></pre> <p>Run: <pre><code>docker-compose run --rm shiroink\n</code></pre></p>"},{"location":"guides/docker/#multi-platform-support","title":"Multi-Platform Support","text":"<p>ShiroInk supports both amd64 and arm64 architectures.</p>"},{"location":"guides/docker/#building-locally","title":"Building Locally","text":"<pre><code>docker build -t shiroink:local .\ndocker run --rm shiroink:local --version\n</code></pre> <p>See the Installation Guide for more details.</p>"},{"location":"guides/installation/","title":"Installation","text":"<p>ShiroInk can be installed and run in multiple ways depending on your preference.</p>"},{"location":"guides/installation/#docker-recommended","title":"Docker (Recommended)","text":"<p>The easiest way to use ShiroInk is via Docker:</p> <pre><code># Pull the latest image\ndocker pull ghcr.io/esoso/shiroink:latest\n\n# Verify installation\ndocker run --rm ghcr.io/esoso/shiroink:latest --version\n</code></pre>"},{"location":"guides/installation/#multi-platform-support","title":"Multi-Platform Support","text":"<p>ShiroInk Docker images support:</p> <ul> <li>linux/amd64 - Intel/AMD processors</li> <li>linux/arm64 - ARM processors (M1/M2 Macs, ARM servers)</li> </ul> <p>Docker will automatically pull the correct image for your architecture.</p>"},{"location":"guides/installation/#python-installation","title":"Python Installation","text":""},{"location":"guides/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11 or higher</li> <li>pip package manager</li> </ul>"},{"location":"guides/installation/#install-dependencies","title":"Install Dependencies","text":"<pre><code># Clone the repository\ngit clone https://github.com/EsOsO/ShiroInk.git\ncd ShiroInk\n\n# Install dependencies\npip install -r requirements.txt\n</code></pre>"},{"location":"guides/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>python src/main.py --version\n</code></pre>"},{"location":"guides/installation/#docker-compose","title":"Docker Compose","text":"<p>For local development, use Docker Compose:</p> <pre><code># Clone the repository\ngit clone https://github.com/EsOsO/ShiroInk.git\ncd ShiroInk\n\n# Build the image\ndocker-compose build\n\n# Run with default settings\ndocker-compose run --rm shiroink\n</code></pre>"},{"location":"guides/installation/#system-requirements","title":"System Requirements","text":""},{"location":"guides/installation/#minimum","title":"Minimum","text":"<ul> <li>CPU: 2 cores</li> <li>RAM: 512MB</li> <li>Storage: 100MB for application, space for processed images</li> </ul>"},{"location":"guides/installation/#recommended","title":"Recommended","text":"<ul> <li>CPU: 4+ cores (for parallel processing)</li> <li>RAM: 2GB</li> <li>Storage: SSD for faster processing</li> </ul>"},{"location":"guides/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide - Get started in 5 minutes</li> <li>Usage Guide - Detailed usage instructions</li> <li>Docker Guide - Advanced Docker usage</li> </ul>"},{"location":"guides/quickstart/","title":"Quick Start","text":"<p>Get up and running with ShiroInk in 5 minutes!</p>"},{"location":"guides/quickstart/#docker-quick-start","title":"Docker Quick Start","text":"<pre><code># Pull the image\ndocker pull ghcr.io/esoso/shiroink:latest\n\n# Process your manga\ndocker run --rm \\\n  -v ./my-manga:/input:ro \\\n  -v ./optimized:/output \\\n  ghcr.io/esoso/shiroink:latest \\\n  /input /output --pipeline kindle\n</code></pre>"},{"location":"guides/quickstart/#what-just-happened","title":"What Just Happened?","text":"<p>ShiroInk processed all images in <code>./my-manga</code> and saved optimized versions to <code>./optimized</code> using the Kindle preset.</p>"},{"location":"guides/quickstart/#try-different-presets","title":"Try Different Presets","text":"<pre><code># For tablets\ndocker run --rm -v ./input:/input:ro -v ./output:/output \\\n  ghcr.io/esoso/shiroink:latest /input /output --pipeline tablet\n\n# For printing\ndocker run --rm -v ./input:/input:ro -v ./output:/output \\\n  ghcr.io/esoso/shiroink:latest /input /output --pipeline print\n</code></pre>"},{"location":"guides/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Full Usage Guide - All options and features</li> <li>Docker Guide - Advanced Docker usage</li> <li>Architecture - How it works</li> </ul>"},{"location":"guides/usage/","title":"Usage Guide","text":"<p>ShiroInk processes images through a configurable pipeline optimized for e-readers, tablets, and other devices.</p>"},{"location":"guides/usage/#basic-command","title":"Basic Command","text":"<pre><code>shiroink &lt;input_directory&gt; &lt;output_directory&gt; [options]\n</code></pre>"},{"location":"guides/usage/#pipeline-presets","title":"Pipeline Presets","text":"<p>Choose an optimization profile based on your target device:</p>"},{"location":"guides/usage/#kindle-default","title":"kindle (Default)","text":"<p>Optimized for Amazon Kindle e-ink readers.</p> <pre><code>shiroink input/ output/ --pipeline kindle\n</code></pre> <p>Best for: - E-Ink readers (Kindle, Kobo, PocketBook) - File size optimization - High contrast environments</p>"},{"location":"guides/usage/#tablet","title":"tablet","text":"<p>Optimized for color LCD displays (iPad, Android tablets).</p> <pre><code>shiroink input/ output/ --pipeline tablet\n</code></pre> <p>Best for: - iPad and Android tablets - Color preservation - Modern LCD screens</p>"},{"location":"guides/usage/#high_quality","title":"high_quality","text":"<p>Maximum quality for archival storage.</p> <pre><code>shiroink input/ output/ --pipeline high_quality\n</code></pre> <p>Best for: - Future-proofing content - Archive storage - Printing - Premium viewing</p>"},{"location":"guides/usage/#minimal","title":"minimal","text":"<p>No processing (fast pass-through).</p> <pre><code>shiroink input/ output/ --pipeline minimal\n</code></pre> <p>Best for: - Quick format conversion - Preserving original quality - Testing</p>"},{"location":"guides/usage/#resolution-settings","title":"Resolution Settings","text":"<p>Set output dimensions for your target device.</p>"},{"location":"guides/usage/#default-resolution","title":"Default Resolution","text":"<p>Uses device-specific dimensions (automatic).</p> <pre><code>shiroink input/ output/\n</code></pre>"},{"location":"guides/usage/#custom-resolution","title":"Custom Resolution","text":"<p>Specify exact width and height:</p> <pre><code># Portrait: 1072x1448 (Kindle Paperwhite)\nshiroink input/ output/ -r 1072x1448\n\n# Landscape: 1448x1072\nshiroink input/ output/ -r 1448x1072\n\n# Square: 1024x1024\nshiroink input/ output/ -r 1024x1024\n\n# Shorthand (square): -r 1024\nshiroink input/ output/ -r 1024\n</code></pre>"},{"location":"guides/usage/#quality-settings","title":"Quality Settings","text":"<p>Control file size vs. image quality (1-9).</p> <pre><code># Lower quality, smaller files (good for e-ink)\nshiroink input/ output/ -q 3\n\n# Default quality (balanced)\nshiroink input/ output/ -q 6\n\n# High quality (larger files)\nshiroink input/ output/ -q 9\n</code></pre>"},{"location":"guides/usage/#processing-options","title":"Processing Options","text":""},{"location":"guides/usage/#right-to-left-mode","title":"Right-to-Left Mode","text":"<p>For manga and RTL content:</p> <pre><code>shiroink input/ output/ --rtl\n</code></pre>"},{"location":"guides/usage/#debug-output","title":"Debug Output","text":"<p>Enable detailed logging:</p> <pre><code>shiroink input/ output/ --debug\n</code></pre> <p>Shows: - Processing steps - File-by-file progress - Error details - Processing time</p>"},{"location":"guides/usage/#dry-run","title":"Dry Run","text":"<p>Test without saving files:</p> <pre><code>shiroink input/ output/ --dry-run\n</code></pre> <p>Useful for: - Testing pipeline configuration - Estimating processing time - Debugging issues</p>"},{"location":"guides/usage/#parallel-workers","title":"Parallel Workers","text":"<p>Control processing speed:</p> <pre><code># Use 2 parallel workers (slower, less memory)\nshiroink input/ output/ -w 2\n\n# Use 8 parallel workers (faster, more memory)\nshiroink input/ output/ -w 8\n\n# Default: 4 workers\nshiroink input/ output/\n</code></pre>"},{"location":"guides/usage/#practical-examples","title":"Practical Examples","text":""},{"location":"guides/usage/#kindle-e-book-processing","title":"Kindle E-Book Processing","text":"<pre><code>shiroink ebook_scans/ kindle_output/ \\\n  --pipeline kindle \\\n  -r 1072x1448 \\\n  -q 6\n</code></pre>"},{"location":"guides/usage/#tablet-viewing","title":"Tablet Viewing","text":"<pre><code>shiroink comics/ tablet_output/ \\\n  --pipeline tablet \\\n  -r 1920x1440 \\\n  --workers 8\n</code></pre>"},{"location":"guides/usage/#archive-storage","title":"Archive Storage","text":"<pre><code>shiroink originals/ archive/ \\\n  --pipeline high_quality \\\n  -q 9\n</code></pre>"},{"location":"guides/usage/#manga-processing","title":"Manga Processing","text":"<pre><code>shiroink manga/ output/ \\\n  --rtl \\\n  --pipeline kindle \\\n  -r 1072x1448\n</code></pre>"},{"location":"guides/usage/#quick-format-conversion","title":"Quick Format Conversion","text":"<pre><code># Fast, no processing\nshiroink images/ output/ --pipeline minimal\n</code></pre>"},{"location":"guides/usage/#batch-processing-with-logging","title":"Batch Processing with Logging","text":"<pre><code>shiroink input/ output/ \\\n  --pipeline kindle \\\n  --debug \\\n  --workers 8 &gt; processing.log 2&gt;&amp;1\n</code></pre>"},{"location":"guides/usage/#supported-formats","title":"Supported Formats","text":"<p>Input: - JPEG, PNG, WebP, GIF, BMP, TIFF</p> <p>Output: - JPEG (default) - PNG (preserves quality)</p>"},{"location":"guides/usage/#error-handling","title":"Error Handling","text":"<p>By default, ShiroInk continues processing even if some files fail:</p> <pre><code># Continue on errors (default)\nshiroink input/ output/\n# Exit code: 0 (success), 1 (errors), 2 (critical)\n\n# Stop on first error\nshiroink input/ output/ --continue-on-error false\n</code></pre>"},{"location":"guides/usage/#performance-tips","title":"Performance Tips","text":"<ol> <li>Use Reasonable Worker Count: 4-8 workers for most systems</li> <li>Match Resolution to Device: Exact device dimensions prevent unnecessary scaling</li> <li>Use Minimal Pipeline: For simple format conversion</li> <li>Dry Run First: Test configuration before full batch</li> </ol>"},{"location":"guides/usage/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/usage/#out-of-memory","title":"Out of Memory","text":"<p>Reduce worker count: <pre><code>shiroink input/ output/ -w 2\n</code></pre></p>"},{"location":"guides/usage/#slow-processing","title":"Slow Processing","text":"<p>Increase worker count or use minimal pipeline: <pre><code>shiroink input/ output/ --pipeline minimal -w 8\n</code></pre></p>"},{"location":"guides/usage/#quality-issues","title":"Quality Issues","text":"<p>Increase quality setting: <pre><code>shiroink input/ output/ -q 9\n</code></pre></p>"},{"location":"guides/usage/#more-information","title":"More Information","text":"<ul> <li>Quick Start - 5-minute setup</li> <li>Device Presets - Device specifications</li> <li>Architecture - How ShiroInk works</li> </ul>"}]}